{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"dNation Kubernetes Monitoring See status of your Kubernetes infrastructure and applications at a glance using semaphore (green/orange/red) principle: It is a set of Grafana dashboards and Prometheus alerts written in Jsonnet . This Monitoring following 3 basic design principles: Intuitive - Green, orange and red colors signaling whether or not your action is needed Drill-down - if you want details why is something green, orange or red, just click it Relevant information only - provide only metrics relevant for this particular area of interest and drill-down level, side-by-side with logs (experimental feature) Monitoring targets are: Kubernetes Hosts Applications Full Installation In case your current Kubernetes installation doesn't contain Prometheus Operator, Grafana or Loki, please install dNation Kubernetes Monitoring Stack helm chart (recommended). Dashboards and Alerts only Installation In case your current Kubernetes installation already contains Prometheus Operator, Grafana and Loki, please follow here . Documentation See the documentation here . Contribution guidelines If you want to contribute, please read following: Contribution Guidelines Code of Conduct How To simplify your local development We use GitHub issues to manage requests and bugs. Commercial support This project has been developed, maintained and used in production by professionals to simplify their day-to-day monitoring tasks and reduce incident reaction time. Commercial support is available, including 24/7, please contact us .","title":"Home"},{"location":"#dnation-kubernetes-monitoring","text":"See status of your Kubernetes infrastructure and applications at a glance using semaphore (green/orange/red) principle: It is a set of Grafana dashboards and Prometheus alerts written in Jsonnet . This Monitoring following 3 basic design principles: Intuitive - Green, orange and red colors signaling whether or not your action is needed Drill-down - if you want details why is something green, orange or red, just click it Relevant information only - provide only metrics relevant for this particular area of interest and drill-down level, side-by-side with logs (experimental feature) Monitoring targets are: Kubernetes Hosts Applications","title":"dNation Kubernetes Monitoring"},{"location":"#full-installation","text":"In case your current Kubernetes installation doesn't contain Prometheus Operator, Grafana or Loki, please install dNation Kubernetes Monitoring Stack helm chart (recommended).","title":"Full Installation"},{"location":"#dashboards-and-alerts-only-installation","text":"In case your current Kubernetes installation already contains Prometheus Operator, Grafana and Loki, please follow here .","title":"Dashboards and Alerts only Installation"},{"location":"#documentation","text":"See the documentation here .","title":"Documentation"},{"location":"#contribution-guidelines","text":"If you want to contribute, please read following: Contribution Guidelines Code of Conduct How To simplify your local development We use GitHub issues to manage requests and bugs.","title":"Contribution guidelines"},{"location":"#commercial-support","text":"This project has been developed, maintained and used in production by professionals to simplify their day-to-day monitoring tasks and reduce incident reaction time. Commercial support is available, including 24/7, please contact us .","title":"Commercial support"},{"location":"CODE_OF_CONDUCT/","text":"dNation Kubernetes Monitoring Code of Conduct Our Pledge We as members, contributors, and leaders pledge to make participation in our community a harassment-free experience for everyone, regardless of age, body size, visible or invisible disability, ethnicity, sex characteristics, gender identity and expression, level of experience, education, socio-economic status, nationality, personal appearance, race, religion, or sexual identity and orientation. We pledge to act and interact in ways that contribute to an open, welcoming, diverse, inclusive, and healthy community. Our Standards Examples of behavior that contributes to a positive environment for our community include: Demonstrating empathy and kindness toward other people Being respectful of differing opinions, viewpoints, and experiences Giving and gracefully accepting constructive feedback Accepting responsibility and apologizing to those affected by our mistakes, and learning from the experience Focusing on what is best not just for us as individuals, but for the overall community Examples of unacceptable behavior include: The use of sexualized language or imagery, and sexual attention or advances of any kind Trolling, insulting or derogatory comments, and personal or political attacks Public or private harassment Publishing others' private information, such as a physical or email address, without their explicit permission Other conduct which could reasonably be considered inappropriate in a professional setting Enforcement Responsibilities Community leaders are responsible for clarifying and enforcing our standards of acceptable behavior and will take appropriate and fair corrective action in response to any behavior that they deem inappropriate, threatening, offensive, or harmful. Community leaders have the right and responsibility to remove, edit, or reject comments, commits, code, wiki edits, issues, and other contributions that are not aligned to this Code of Conduct, and will communicate reasons for moderation decisions when appropriate. Scope This Code of Conduct applies within all community spaces, and also applies when an individual is officially representing the community in public spaces. Examples of representing our community include using an official e-mail address, posting via an official social media account, or acting as an appointed representative at an online or offline event. Enforcement Instances of abusive, harassing, or otherwise unacceptable behavior may be reported to the community leaders responsible for enforcement at [INSERT CONTACT METHOD]. All complaints will be reviewed and investigated promptly and fairly. All community leaders are obligated to respect the privacy and security of the reporter of any incident. Enforcement Guidelines Community leaders will follow these Community Impact Guidelines in determining the consequences for any action they deem in violation of this Code of Conduct: 1. Correction Community Impact : Use of inappropriate language or other behavior deemed unprofessional or unwelcome in the community. Consequence : A private, written warning from community leaders, providing clarity around the nature of the violation and an explanation of why the behavior was inappropriate. A public apology may be requested. 2. Warning Community Impact : A violation through a single incident or series of actions. Consequence : A warning with consequences for continued behavior. No interaction with the people involved, including unsolicited interaction with those enforcing the Code of Conduct, for a specified period of time. This includes avoiding interactions in community spaces as well as external channels like social media. Violating these terms may lead to a temporary or permanent ban. 3. Temporary Ban Community Impact : A serious violation of community standards, including sustained inappropriate behavior. Consequence : A temporary ban from any sort of interaction or public communication with the community for a specified period of time. No public or private interaction with the people involved, including unsolicited interaction with those enforcing the Code of Conduct, is allowed during this period. Violating these terms may lead to a permanent ban. 4. Permanent Ban Community Impact : Demonstrating a pattern of violation of community standards, including sustained inappropriate behavior, harassment of an individual, or aggression toward or disparagement of classes of individuals. Consequence : A permanent ban from any sort of public interaction within the community. Attribution This Code of Conduct is adapted from the Contributor Covenant , version 2.0, available at https://www.contributor-covenant.org/version/2/0/code_of_conduct.html . Community Impact Guidelines were inspired by Mozilla's code of conduct enforcement ladder . For answers to common questions about this code of conduct, see the FAQ at https://www.contributor-covenant.org/faq . Translations are available at https://www.contributor-covenant.org/translations .","title":"dNation Kubernetes Monitoring Code of Conduct"},{"location":"CODE_OF_CONDUCT/#dnation-kubernetes-monitoring-code-of-conduct","text":"","title":"dNation Kubernetes Monitoring Code of Conduct"},{"location":"CODE_OF_CONDUCT/#our-pledge","text":"We as members, contributors, and leaders pledge to make participation in our community a harassment-free experience for everyone, regardless of age, body size, visible or invisible disability, ethnicity, sex characteristics, gender identity and expression, level of experience, education, socio-economic status, nationality, personal appearance, race, religion, or sexual identity and orientation. We pledge to act and interact in ways that contribute to an open, welcoming, diverse, inclusive, and healthy community.","title":"Our Pledge"},{"location":"CODE_OF_CONDUCT/#our-standards","text":"Examples of behavior that contributes to a positive environment for our community include: Demonstrating empathy and kindness toward other people Being respectful of differing opinions, viewpoints, and experiences Giving and gracefully accepting constructive feedback Accepting responsibility and apologizing to those affected by our mistakes, and learning from the experience Focusing on what is best not just for us as individuals, but for the overall community Examples of unacceptable behavior include: The use of sexualized language or imagery, and sexual attention or advances of any kind Trolling, insulting or derogatory comments, and personal or political attacks Public or private harassment Publishing others' private information, such as a physical or email address, without their explicit permission Other conduct which could reasonably be considered inappropriate in a professional setting","title":"Our Standards"},{"location":"CODE_OF_CONDUCT/#enforcement-responsibilities","text":"Community leaders are responsible for clarifying and enforcing our standards of acceptable behavior and will take appropriate and fair corrective action in response to any behavior that they deem inappropriate, threatening, offensive, or harmful. Community leaders have the right and responsibility to remove, edit, or reject comments, commits, code, wiki edits, issues, and other contributions that are not aligned to this Code of Conduct, and will communicate reasons for moderation decisions when appropriate.","title":"Enforcement Responsibilities"},{"location":"CODE_OF_CONDUCT/#scope","text":"This Code of Conduct applies within all community spaces, and also applies when an individual is officially representing the community in public spaces. Examples of representing our community include using an official e-mail address, posting via an official social media account, or acting as an appointed representative at an online or offline event.","title":"Scope"},{"location":"CODE_OF_CONDUCT/#enforcement","text":"Instances of abusive, harassing, or otherwise unacceptable behavior may be reported to the community leaders responsible for enforcement at [INSERT CONTACT METHOD]. All complaints will be reviewed and investigated promptly and fairly. All community leaders are obligated to respect the privacy and security of the reporter of any incident.","title":"Enforcement"},{"location":"CODE_OF_CONDUCT/#enforcement-guidelines","text":"Community leaders will follow these Community Impact Guidelines in determining the consequences for any action they deem in violation of this Code of Conduct:","title":"Enforcement Guidelines"},{"location":"CODE_OF_CONDUCT/#1-correction","text":"Community Impact : Use of inappropriate language or other behavior deemed unprofessional or unwelcome in the community. Consequence : A private, written warning from community leaders, providing clarity around the nature of the violation and an explanation of why the behavior was inappropriate. A public apology may be requested.","title":"1. Correction"},{"location":"CODE_OF_CONDUCT/#2-warning","text":"Community Impact : A violation through a single incident or series of actions. Consequence : A warning with consequences for continued behavior. No interaction with the people involved, including unsolicited interaction with those enforcing the Code of Conduct, for a specified period of time. This includes avoiding interactions in community spaces as well as external channels like social media. Violating these terms may lead to a temporary or permanent ban.","title":"2. Warning"},{"location":"CODE_OF_CONDUCT/#3-temporary-ban","text":"Community Impact : A serious violation of community standards, including sustained inappropriate behavior. Consequence : A temporary ban from any sort of interaction or public communication with the community for a specified period of time. No public or private interaction with the people involved, including unsolicited interaction with those enforcing the Code of Conduct, is allowed during this period. Violating these terms may lead to a permanent ban.","title":"3. Temporary Ban"},{"location":"CODE_OF_CONDUCT/#4-permanent-ban","text":"Community Impact : Demonstrating a pattern of violation of community standards, including sustained inappropriate behavior, harassment of an individual, or aggression toward or disparagement of classes of individuals. Consequence : A permanent ban from any sort of public interaction within the community.","title":"4. Permanent Ban"},{"location":"CODE_OF_CONDUCT/#attribution","text":"This Code of Conduct is adapted from the Contributor Covenant , version 2.0, available at https://www.contributor-covenant.org/version/2/0/code_of_conduct.html . Community Impact Guidelines were inspired by Mozilla's code of conduct enforcement ladder . For answers to common questions about this code of conduct, see the FAQ at https://www.contributor-covenant.org/faq . Translations are available at https://www.contributor-covenant.org/translations .","title":"Attribution"},{"location":"CONTRIBUTING/","text":"dNation Kubernetes Monitoring Contributing Guidelines Thank you for considering to contribute to dNation Kubernetes Monitoring project. When contributing to this repository, please first discuss the change you wish to make via issue, email, or by any other method with the owners of this repository before making a change. Pull Request Checklist Before sending your pull requests, make sure you followed this list. Read Contributing Guidelines Read Code of Conduct Read Commit Message Convention Read How To simplify your local development Set up the Developer Certificate of Origin (DCO) Include a License at the top of new files Update the Readme with details of changes to the interface In case the pull request would update the version number, please edit the version number in all appropriate files e.g. Chart.yaml . The versioning scheme we use is SemVer You may merge the Pull Request once you have the sign-off of two other developers, or if you don't have the permission to do that, you may request the second reviewer to merge it for you Developer Certificate of Origin (DCO) The Developer Certificate of Origin (DCO) is a legally binding statement that asserts that you are the creator of your contribution, and that you wish to allow dNation Kubernetes Monitoring project to use your work. Acknowledgement of this permission is done using a sign-off process in Git. The sign-off is a simple line at the end of the explanation for the patch. The text of the DCO is available on developercertificate.org . If you are willing to agree to these terms, you just add a line to every git commit message: Signed-off-by: Joe Smith <joe.smith@email.com> If you set your user.name and user.email as part of your git configuration, you can sign your commit automatically with git commit -s . Unfortunately, you have to use your real name (i.e., pseudonyms or anonymous contributions cannot be made). This is because the DCO is a legally binding document, granting the dNation Kubernetes Monitoring project to use your work. License on the top of file /* Copyright 2020 The dNation Kubernetes Monitoring Authors. All Rights Reserved. Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. */","title":"dNation Kubernetes Monitoring Contributing Guidelines"},{"location":"CONTRIBUTING/#dnation-kubernetes-monitoring-contributing-guidelines","text":"Thank you for considering to contribute to dNation Kubernetes Monitoring project. When contributing to this repository, please first discuss the change you wish to make via issue, email, or by any other method with the owners of this repository before making a change.","title":"dNation Kubernetes Monitoring Contributing Guidelines"},{"location":"CONTRIBUTING/#pull-request-checklist","text":"Before sending your pull requests, make sure you followed this list. Read Contributing Guidelines Read Code of Conduct Read Commit Message Convention Read How To simplify your local development Set up the Developer Certificate of Origin (DCO) Include a License at the top of new files Update the Readme with details of changes to the interface In case the pull request would update the version number, please edit the version number in all appropriate files e.g. Chart.yaml . The versioning scheme we use is SemVer You may merge the Pull Request once you have the sign-off of two other developers, or if you don't have the permission to do that, you may request the second reviewer to merge it for you","title":"Pull Request Checklist"},{"location":"CONTRIBUTING/#developer-certificate-of-origin-dco","text":"The Developer Certificate of Origin (DCO) is a legally binding statement that asserts that you are the creator of your contribution, and that you wish to allow dNation Kubernetes Monitoring project to use your work. Acknowledgement of this permission is done using a sign-off process in Git. The sign-off is a simple line at the end of the explanation for the patch. The text of the DCO is available on developercertificate.org . If you are willing to agree to these terms, you just add a line to every git commit message: Signed-off-by: Joe Smith <joe.smith@email.com> If you set your user.name and user.email as part of your git configuration, you can sign your commit automatically with git commit -s . Unfortunately, you have to use your real name (i.e., pseudonyms or anonymous contributions cannot be made). This is because the DCO is a legally binding document, granting the dNation Kubernetes Monitoring project to use your work.","title":"Developer Certificate of Origin (DCO)"},{"location":"CONTRIBUTING/#license-on-the-top-of-file","text":"/* Copyright 2020 The dNation Kubernetes Monitoring Authors. All Rights Reserved. Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. */","title":"License on the top of file"},{"location":"GETTING_STARTED/","text":"Dashboards and Alerts only Installation Installation on top of an existing monitoring infrastructure (Prometheus Operator, Grafana and Loki are already installed). Installation Prerequisites * Helm3 dNation Kubernetes Monitoring helm chart is hosted in the dNation helm repository . # Add dNation helm repository helm repo add dnationcloud https://dnationcloud.github.io/helm-hub/ helm repo update # Install dNation Kubernetes Monitoring helm install dnation-kubernetes-monitoring dnationcloud/dnation-kubernetes-monitoring Search for Monitoring dashboard. The fun starts here :). If you want to set the Monitoring dashboard as a home dashboard follow here . If you're experiencing issues please read FAQ . Configuration Default values for dNation Kubernetes Monitoring are defined by merging of jsonnet/config.libsonnet and chart/values.yaml files. Full list of possible configuration parameters are listed in the project documentation . All default values can be overridden as in standard helm chart, see examples in helpers directory.","title":"Dashboards and Alerts only Installation"},{"location":"GETTING_STARTED/#dashboards-and-alerts-only-installation","text":"Installation on top of an existing monitoring infrastructure (Prometheus Operator, Grafana and Loki are already installed).","title":"Dashboards and Alerts only Installation"},{"location":"GETTING_STARTED/#installation","text":"Prerequisites * Helm3 dNation Kubernetes Monitoring helm chart is hosted in the dNation helm repository . # Add dNation helm repository helm repo add dnationcloud https://dnationcloud.github.io/helm-hub/ helm repo update # Install dNation Kubernetes Monitoring helm install dnation-kubernetes-monitoring dnationcloud/dnation-kubernetes-monitoring Search for Monitoring dashboard. The fun starts here :). If you want to set the Monitoring dashboard as a home dashboard follow here . If you're experiencing issues please read FAQ .","title":"Installation"},{"location":"GETTING_STARTED/#configuration","text":"Default values for dNation Kubernetes Monitoring are defined by merging of jsonnet/config.libsonnet and chart/values.yaml files. Full list of possible configuration parameters are listed in the project documentation . All default values can be overridden as in standard helm chart, see examples in helpers directory.","title":"Configuration"},{"location":"chart/","text":"dNation Kubernetes Monitoring Please follow instructions described in dNation Kubernetes Monitoring project.","title":"dNation Kubernetes Monitoring"},{"location":"chart/#dnation-kubernetes-monitoring","text":"Please follow instructions described in dNation Kubernetes Monitoring project.","title":"dNation Kubernetes Monitoring"},{"location":"docs/README_DOCS/","text":"Kubernetes Monitoring Documentation Generate documentation Prerequisites - Python3 pip3 install -r \"docs/requirements.txt\" make docs-generate Afterwards folder docs/site with static website is created. Local development Python script docs/generate_md_docs.py is responsible for creating markdown documents from configuration files. Mkdocs tool is used for generating documentation website from markdown files. Tool comes with built-in dev-server that can be used to preview work on documentation. # whole project is copied inside docs/project folder rsync -Rr ./ docs/project cd docs/project python3 docs/generate_md_docs.py cd .. mkdocs serve Mkdocs doesn't have access to files outside docs_dir (in our case docs/project ) and configuration file ( mkdocs.yaml ) has to be at least one level above docs_dir in filesystem tree. Therefore whole project has to be copied inside docs/project to allow Mkdocs to access files like chart/README.md or helpers/FAQ.md . To see changes at dev-server, files inside docs/project has to be modified. After development is done, changes has to be copied to kubernetes-monitoring folder and command make docs-generate has to be run. Other option that avoids copying changes is using symlink. # symlink to kubernets-monitoring folder is created inside docs folder ln -s .. docs/project python3 docs/generate_md_docs.py cd docs mkdocs serve --no-livereload Disadvantage is unability to use livereload because of 'infinite path' of symlink ( docs/project/docs/project/... ). Server has to be restarted to reload changes. After development is done, symlink has to be deleted and command make docs-generate run. CI/CD Github workflow is used to regenerate documentation and deploy site to branch gh-pages if changes are made inside docs folder, any REAMDE file or in configuration files.","title":"Kubernetes Monitoring Documentation"},{"location":"docs/README_DOCS/#kubernetes-monitoring-documentation","text":"","title":"Kubernetes Monitoring Documentation"},{"location":"docs/README_DOCS/#generate-documentation","text":"Prerequisites - Python3 pip3 install -r \"docs/requirements.txt\" make docs-generate Afterwards folder docs/site with static website is created.","title":"Generate documentation"},{"location":"docs/README_DOCS/#local-development","text":"Python script docs/generate_md_docs.py is responsible for creating markdown documents from configuration files. Mkdocs tool is used for generating documentation website from markdown files. Tool comes with built-in dev-server that can be used to preview work on documentation. # whole project is copied inside docs/project folder rsync -Rr ./ docs/project cd docs/project python3 docs/generate_md_docs.py cd .. mkdocs serve Mkdocs doesn't have access to files outside docs_dir (in our case docs/project ) and configuration file ( mkdocs.yaml ) has to be at least one level above docs_dir in filesystem tree. Therefore whole project has to be copied inside docs/project to allow Mkdocs to access files like chart/README.md or helpers/FAQ.md . To see changes at dev-server, files inside docs/project has to be modified. After development is done, changes has to be copied to kubernetes-monitoring folder and command make docs-generate has to be run. Other option that avoids copying changes is using symlink. # symlink to kubernets-monitoring folder is created inside docs folder ln -s .. docs/project python3 docs/generate_md_docs.py cd docs mkdocs serve --no-livereload Disadvantage is unability to use livereload because of 'infinite path' of symlink ( docs/project/docs/project/... ). Server has to be restarted to reload changes. After development is done, symlink has to be deleted and command make docs-generate run.","title":"Local development"},{"location":"docs/README_DOCS/#cicd","text":"Github workflow is used to regenerate documentation and deploy site to branch gh-pages if changes are made inside docs folder, any REAMDE file or in configuration files.","title":"CI/CD"},{"location":"docs/documentation-intro/","text":"dnation Kubernetes Monitoring Docs This is generated documentation from configuration files of Kubernetes Monitoring . Each configuration parameter can be overriden by providing custom values.yaml during helm installation.","title":"Documentation intro"},{"location":"docs/documentation-intro/#dnation-kubernetes-monitoring-docs","text":"This is generated documentation from configuration files of Kubernetes Monitoring . Each configuration parameter can be overriden by providing custom values.yaml during helm installation.","title":"dnation Kubernetes Monitoring Docs"},{"location":"docs/documentation/","text":"dnation Kubernetes Monitoring Docs This is generated documentation from configuration files of Kubernetes Monitoring . Each configuration parameter can be overriden by providing custom values.yaml during helm installation. Property Value clusterMonitoring clusterMonitoring commonLabels {} dnation-kubernetes-jsonnet-translator dnation-kubernetes-jsonnet-translator fullnameOverride grafanaDashboards grafanaDashboards hostMonitoring hostMonitoring nameOverride namespaceOverride prometheusRules prometheusRules templates templates clusterMonitoring Property Value clusters - apps: [] description: Kubernetes cluster monitoring name: K8sCluster enabled True dnation-kubernetes-jsonnet-translator Property Value enabled True image image image Property Value args - --libsonnet - https://github.com/grafana/grafonnet-lib/grafonnet@005390f0207ffa4a8ae0d1afb253b7585ff7beca - https://github.com/thelastpickle/grafonnet-polystat-panel@275a48de57afdac0d72219d82863d8ab8bd0e682 grafanaDashboards Property Value color color constants infinity: 999999999 dataLinkCommonArgs refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to editable True enable True ids ids isLoki True labelGrafana grafana_dashboard: '1' labelJsonnet grafana_dashboard_jsonnet: '1' refresh 10s selectors selectors severityColors severityColors tags tags templateRefresh time templateSort 5 time_from now-5m tooltip shared_crosshair color Property Value black #000000 blue #5794f2 green #56a64b lightblue #8ab8ff orange #ff780a pink #fce2de purple #a352cc red #e02f44 white #ffffff yellow #fade2a ids Property Value alertClusterOverview alertclusteroverview alertHostOverview alerthostoverview apache apache apiServer apiserver autoscaler autoscaler cAdvisor cadvisor containerDetail containerdetail containerOverview containeroverview controllerManager controllermanager cpuNamespaceOverview cpunamespaceoverview cpuOverview cpuoverview daemonSetOverview daemonsetoverview deploymentOverview deploymentoverview diskOverview diskoverview etcd etcd hostMonitoring hostmonitoring javaActuator javaactuator jobOverview joboverview k8sMonitoring k8smonitoring kubelet kubelet memoryNamespaceOverview memorynamespaceoverview memoryOverview memoryoverview monitoring monitoring networkNamespaceOverview networknamespaceoverview networkOverview networkoverview nginxIngress nginxingress nginxNrpe nginxnrpe nginxVts nginxvts nodeExporter nodeexporter nodeOverview nodeoverview persistentVolumes persistentvolumes phpFpm phpfpm podOverview podoverview postfix postfix proxy proxy pvcOverview pvcoverview pythonFlask pythonflask rabbitmq rabbitmq scheduler scheduler statefulSet statefulset statefulSetOverview statefulsetoverview selectors Property Value apiServer job=\"apiserver\" controllerManager job=\"kube-controller-manager\" etcd job=\"kube-etcd\" kubelet job=\"kubelet\" proxy job=\"kube-proxy\" scheduler job=\"kube-scheduler\" severityColors Property Value critical red default green invalid black warning orange tags Property Value k8sApps - k8s - app - L1 k8sAppsMain - k8s - app - L0 k8sContainer - k8s - container - L3 k8sHostsMain - k8s - host - L1 k8sMonitoring - k8s - monitoring - L1 k8sMonitoringMain - k8s - cluster - host - L0 k8sNodeExporter - k8s - nodeexporter - L3 k8sOverview - k8s - overview - L2 k8sPVC - k8s - pvc - L3 k8sStatefulSet - k8s - statefulset - L3 k8sSystem - k8s - system - L2 hostMonitoring Property Value enabled False hosts [] prometheusRules Property Value alertGroupCluster Cluster alertGroupClusterApp ClusterApp alertGroupHost Host alertGroupHostApp HostApp alertInterval 5m alertNamePrefix KubernetesMonitoring enable True labelJsonnet prometheus_rule_jsonnet: '1' labelPrometheus prometheus_rule: '1' templates Property Value baseStatsTemplate baseStatsTemplate commonThresholds commonThresholds host host hostApps hostApps k8s k8s k8sApps k8sApps baseStatsTemplate Property Value alert {} default True enabled True panel panel panel Property Value colorMode background dataLinks [] datasource $datasource description expr graphMode area gridPos gridPos mappings [] thresholds {} title error must be overwritten unit percent gridPos Property Value h 3 w 6 x error must be overwritten y error must be overwritten commonThresholds Property Value app app controlPlane controlPlane criticalPanel criticalPanel k8s k8s node node warningPanel warningPanel app Property Value critical 95 operator < warning 99 controlPlane Property Value critical 95 operator < warning 99 criticalPanel Property Value critical 1 operator >= k8s Property Value critical 95 operator < warning 99 node Property Value critical 90 operator >= warning 75 warningPanel Property Value operator >= warning 1 host Property Value overallNetworkErrors overallNetworkErrors overallUtilizationCPU overallUtilizationCPU overallUtilizationDisk overallUtilizationDisk overallUtilizationRAM overallUtilizationRAM targetDown targetDown totalCores totalCores totalDisk totalDisk totalRAM totalRAM usedCores usedCores usedDisk usedDisk usedRAM usedRAM overallNetworkErrors Property Value alert alert panel panel alert Property Value customLables alertgroup: Host expr sum(rate(node_network_transmit_errs_total{cluster=~\"$cluster|\", job!~\"node-exporter\", device!~\"lo|veth.+|docker.+|flannel.+|cali.+|cbr.|cni.+|br.+\"} [5m]) * on(instance) group_left(nodename) (node_uname_info) ) by (job, nodename) + sum(rate(node_network_receive_errs_total{cluster=~\"$cluster|\", job!~\"node-exporter\", device!~\"lo|veth.+|docker.+|flannel.+|cali.+|cbr.|cni.+|br.+\"}[5m]) * on(instance) group_left(nodename) (node_uname_info) ) by (job, nodename) message Host {{ $labels.nodename }}: High Overall Network Errors Count {{ $value }}% name HostNetworkOverallErrorsHigh thresholds critical: 15 operator: '>=' warning: 10 panel Property Value dataLinks - title: System Overview url: /d/nodeexporter?var-job=$job&refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr sum(rate(node_network_transmit_errs_total{cluster=~\"$cluster|\", job=~\"$job\", device!~\"lo|veth.+|docker.+|flannel.+|cali.+|cbr.|cni.+|br.+\"} [5m]) * on(instance) group_left(nodename) (node_uname_info) ) by (job, nodename) + sum(rate(node_network_receive_errs_total{cluster=~\"$cluster|\", job=~\"$job\", device!~\"lo|veth.+|docker.+|flannel.+|cali.+|cbr.|cni.+|br.+\"}[5m]) * on(instance) group_left(nodename) (node_uname_info) ) by (job, nodename) gridPos x: 18 y: 6 thresholds critical: 15 operator: '>=' warning: 10 title Overall Errors unit pps overallUtilizationCPU Property Value alert alert panel panel alert Property Value customLables alertgroup: Host expr round((1 - (avg(irate(node_cpu_seconds_total{cluster=~\"$cluster|\", job!~\"node-exporter\", mode=\"idle\"}[5m]) * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename) )) * 100) message Host {{ $labels.nodename }}: High CPU Overall Utilization {{ $value }}% name HostCPUOverallHigh thresholds critical: 90 operator: '>=' warning: 75 panel Property Value dataLinks - title: System Overview url: /d/nodeexporter?var-job=$job&refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr avg(round((1 - (avg(irate(node_cpu_seconds_total{cluster=~\"$cluster|\", job=~\"$job\", mode=\"idle\"}[5m]) * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename) )) * 100)) gridPos x: 0 y: 6 thresholds critical: 90 operator: '>=' warning: 75 title Overall Utilization overallUtilizationDisk Property Value alert alert panel panel alert Property Value customLables alertgroup: Host expr round((sum(node_filesystem_size_bytes{cluster=~\"$cluster|\", job!~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster|\", job!~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) / ((sum(node_filesystem_size_bytes{cluster=~\"$cluster|\", job!~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster|\", job!~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) + sum(node_filesystem_avail_bytes{cluster=~\"$cluster|\", job!~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) * 100 > 0) message Host {{ $labels.nodename }}: High Disk Overall Utilization {{ $value }}% name HostDiskOverallHigh thresholds critical: 90 operator: '>=' warning: 75 panel Property Value dataLinks - title: System Overview url: /d/nodeexporter?var-job=$job&refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to description The percentage of the disk utilization is calculated using the fraction: <space used>/(<space used> + <space free>) The value of is reduced by 5% of the available disk capacity, because the file system marks 5% of the available disk capacity as reserved. If less than 5% is free, using the remaining reserved space requires root privileges. Any non-privileged users and processes are unable to write new data to the partition. See the list of explicitly ignored mount points and file systems [here](https://github.com/dNationCloud/kubernetes-monitoring-stack/blob/main/chart/values.yaml) expr max(round((sum(node_filesystem_size_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) / ((sum(node_filesystem_size_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) + sum(node_filesystem_avail_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) * 100 > 0)) gridPos x: 12 y: 6 thresholds critical: 90 operator: '>=' warning: 75 title Overall Utilization overallUtilizationRAM Property Value alert alert panel panel alert Property Value customLables alertgroup: Host expr round((1 - sum by (job, nodename) (node_memory_MemAvailable_bytes{cluster=~\"$cluster|\", job!~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) / sum by (job, nodename) (node_memory_MemTotal_bytes{cluster=~\"$cluster|\", job!~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info))) * 100) message Host {{ $labels.nodename }}: High RAM Overall Utilization {{ $value }}% name HostRAMOverallHigh thresholds critical: 90 operator: '>=' warning: 75 panel Property Value dataLinks - title: System Overview url: /d/nodeexporter?var-job=$job&refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to description The percentage of the memory utilization is calculated by: 1 - (<memory available>/<memory total>) expr avg(round((1 - sum by (job, nodename) (node_memory_MemAvailable_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) / sum by (job, nodename) (node_memory_MemTotal_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info))) * 100)) gridPos x: 6 y: 6 thresholds critical: 90 operator: '>=' warning: 75 title Overall Utilization targetDown Property Value alert alert panel None alert Property Value customLables alertgroup: Host expr 100 * (count by(job, namespace, service) (up{alertGroup=\"Host\"} == 0) / count by(job, namespace, service) (up{alertGroup=\"Host\"})) message {{ printf \"%.4g\" $value }}% of the {{ $labels.job }}/{{ $labels.service }} targets in {{ $labels.namespace }} namespace are down. name HostTargetDown thresholds critical: 90 operator: '>=' warning: 10 totalCores Property Value panel panel panel Property Value colorMode value expr count(node_cpu_seconds_total{cluster=~\"$cluster\", job=~\"$job\", mode=\"system\"}) graphMode none gridPos h: 2 w: 3 x: 3 y: 9 thresholds color: '#ffffff' value: title Total Cores unit none totalDisk Property Value panel panel panel Property Value colorMode value expr sum(node_filesystem_size_bytes{cluster=~\"$cluster\", job=~\"$job\"}) graphMode none gridPos h: 2 w: 3 x: 15 y: 9 thresholds color: '#ffffff' value: title Total unit bytes totalRAM Property Value panel panel panel Property Value colorMode value expr sum(node_memory_MemTotal_bytes{cluster=~\"$cluster\", job=~\"$job\"}) graphMode none gridPos h: 2 w: 3 x: 9 y: 9 thresholds color: '#ffffff' value: title Total unit bytes usedCores Property Value panel panel panel Property Value colorMode value expr (1 - (avg(irate(node_cpu_seconds_total{cluster=~\"$cluster\", job=~\"$job\", mode=\"idle\"}[5m])))) * count(node_cpu_seconds_total{cluster=~\"$cluster\", job=~\"$job\", mode=\"system\"}) graphMode none gridPos h: 2 w: 3 x: 0 y: 9 thresholds color: '#ffffff' value: title Used Cores unit none usedDisk Property Value panel panel panel Property Value colorMode value expr sum(node_filesystem_size_bytes{cluster=~\"$cluster\", job=~\"$job\"}) * ((max((sum(node_filesystem_size_bytes{cluster=~\"$cluster\", job=~\"$job\"}) by (device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster\", job=~\"$job\"}) by (device)) / (sum(node_filesystem_size_bytes{cluster=~\"$cluster\", job=~\"$job\"}) by (device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster\", job=~\"$job\"}) by (device) + sum(node_filesystem_avail_bytes{cluster=~\"$cluster\", job=~\"$job\"}) by (device))))) graphMode none gridPos h: 2 w: 3 x: 12 y: 9 thresholds color: '#ffffff' value: title Used unit bytes usedRAM Property Value panel panel panel Property Value colorMode value expr sum(node_memory_MemTotal_bytes{cluster=~\"$cluster\", job=~\"$job\"}) * (((1 - sum(node_memory_MemAvailable_bytes{cluster=~\"$cluster\", job=~\"$job\"}) / sum(node_memory_MemTotal_bytes{cluster=~\"$cluster\", job=~\"$job\"})))) graphMode none gridPos h: 2 w: 3 x: 6 y: 9 thresholds color: '#ffffff' value: title Used unit bytes hostApps Property Value apache apache autoscaler autoscaler cAdvisor cAdvisor genericApp genericApp javaActuator javaActuator nginxIngress nginxIngress nginxNrpe nginxNrpe nginxVts nginxVts phpFpm phpFpm postfix postfix pythonFlask pythonFlask rabbitmq rabbitmq apache Property Value alert {} default False panel panel panel Property Value expr (sum(up{%(job)s}) / count(up{cluster=~\"$cluster|\", %(job)s}))*100 OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 95 lowest: 0 operator: < warning: 99 autoscaler Property Value alert alert default False panel panel alert Property Value customLables alertgroup: HostApp expr (sum by (job) (autoscaler_healthy{cluster=~\"$cluster|\", job=~\".+\"}) / sum by (job) (autoscaler_instances{cluster=~\"$cluster|\", job=~\".+\"}) * 100) message HostApp {{ $labels.job }}: Autoscaler Health Low {{ $value }}% name HostAppAutoscalerHealthLow thresholds critical: 85 lowest: 0 operator: < warning: 95 panel Property Value expr (sum by (job) (autoscaler_healthy{cluster=~\"$cluster|\", %(job)s}) / sum by (job) (autoscaler_instances{cluster=~\"$cluster|\", %(job)s}) * 100) OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 85 lowest: 0 operator: < warning: 95 cAdvisor Property Value alert {} default False panel panel panel Property Value expr (sum(up{%(job)s}) / count(up{cluster=~\"$cluster|\", %(job)s}))*100 OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 95 lowest: 0 operator: < warning: 99 genericApp Property Value alert {} default False panel panel panel Property Value description GenericApp template. Used when application monitoring is requested but appropriate template was not found. expr (sum(up{%(job)s}) / count(up{cluster=~\"$cluster|\", %(job)s}))*100 gridPos w: 4 thresholds critical: 95 operator: < warning: 99 javaActuator Property Value alert alert default False panel panel alert Property Value customLables alertgroup: HostApp expr (sum by (job) (jvm_memory_used_bytes{cluster=~\"$cluster|\", job=~\".+\", area=\"heap\"})*100/sum by (job) (jvm_memory_max_bytes{cluster=~\"$cluster|\", job=~\".+\", area=\"nonheap\"}) > sum by (job) (jvm_memory_used_bytes{cluster=~\"$cluster|\", job=~\".+\", area=\"nonheap\"})*100/sum by (job) (jvm_memory_max_bytes{cluster=~\"$cluster|\", job=~\".+\", area=\"heap\"}) or (sum by (job) (jvm_memory_used_bytes{cluster=~\"$cluster|\", job=~\".+\", area=\"nonheap\"})*100)/sum by (job) (jvm_memory_max_bytes{cluster=~\"$cluster|\", job=~\".+\", area=\"heap\"})) message HostApp {{ $labels.job }}: Java Actuator Heap High {{ $value }}% name HostAppJavaActuatorHeapHigh thresholds critical: 90 lowest: 0 operator: '>=' warning: 75 panel Property Value expr (sum by (job) (jvm_memory_used_bytes{cluster=~\"$cluster|\", %(job)s, area=\"heap\"})*100/sum by (job) (jvm_memory_max_bytes{cluster=~\"$cluster|\", %(job)s, area=\"nonheap\"}) > sum by (job) (jvm_memory_used_bytes{cluster=~\"$cluster|\", %(job)s, area=\"nonheap\"})*100/sum by (job) (jvm_memory_max_bytes{cluster=~\"$cluster|\", %(job)s, area=\"heap\"}) or (sum by (job) (jvm_memory_used_bytes{cluster=~\"$cluster|\", %(job)s, area=\"nonheap\"})*100)/sum by (job) (jvm_memory_max_bytes{cluster=~\"$cluster|\", %(job)s, area=\"heap\"})) OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 90 lowest: 0 operator: '>=' warning: 75 nginxIngress Property Value alert alert default False panel panel alert Property Value customLables alertgroup: HostApp expr ((sum by (job) (rate(nginx_ingress_controller_requests{cluster=~\"$cluster|\", job=~\".+\", status!~\"[4-5].*\"}[5m])) / sum by (job) (rate(nginx_ingress_controller_requests{cluster=~\"$cluster|\", job=~\".+\"}[5m])) * 100) > 0 OR (sum by (job) (rate(nginx_ingress_controller_requests{cluster=~\"$cluster|\", job=~\".+\"}[5m])) + 100)) message HostApp {{ $labels.job }}: Nginx Ingress Success Rate (non-4|5xx responses) Low {{ $value }}% name HostAppNginxIngressSuccessRateLow thresholds critical: 85 lowest: 0 operator: < warning: 95 panel Property Value expr ((sum by (job) (rate(nginx_ingress_controller_requests{cluster=~\"$cluster|\", %(job)s, status!~\"[4-5].*\"}[5m])) / sum by (job) (rate(nginx_ingress_controller_requests{cluster=~\"$cluster|\", %(job)s}[5m])) * 100) > 0 OR (sum by (job) (rate(nginx_ingress_controller_requests{cluster=~\"$cluster|\", %(job)s}[5m])) + 100)) OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 85 lowest: 0 operator: < warning: 95 nginxNrpe Property Value alert {} default False panel panel panel Property Value expr (sum(up{%(job)s}) / count(up{cluster=~\"$cluster|\", %(job)s}))*100 OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 95 lowest: 0 operator: < warning: 99 nginxVts Property Value alert alert default False panel panel alert Property Value customLables alertgroup: HostApp expr (sum by (job) (rate(nginx_server_requests{cluster=~\"$cluster|\", job=~\".+\", code!~\"[4-5].*\", code!=\"total\"}[5m])) / sum by (job) (rate(nginx_server_requests{cluster=~\"$cluster|\", job=~\".+\", code!=\"total\"}[5m])) * 100) > 0 OR (sum by (job) (rate(nginx_server_requests{cluster=~\"$cluster|\", job=~\".+\"}[5m])) + 100) message HostApp {{ $labels.job }}: Nginx VTS Success Rate (non-4|5xx responses) Low {{ $value }}% name HostAppNginxVTSSuccessRateLow thresholds critical: 85 lowest: 0 operator: < warning: 95 panel Property Value expr (sum by (job) (rate(nginx_server_requests{cluster=~\"$cluster|\", %(job)s, code!~\"[4-5].*\", code!=\"total\"}[5m])) / sum by (job) (rate(nginx_server_requests{cluster=~\"$cluster|\", %(job)s, code!=\"total\"}[5m])) * 100) > 0 OR (sum by (job) (rate(nginx_server_requests{cluster=~\"$cluster|\", %(job)s}[5m])) + 100) OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 85 lowest: 0 operator: < warning: 95 phpFpm Property Value alert {} default False panel panel panel Property Value expr (sum(up{%(job)s}) / count(up{cluster=~\"$cluster|\", %(job)s}))*100 OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 95 lowest: 0 operator: < warning: 99 postfix Property Value alert alert default False panel panel alert Property Value customLables alertgroup: HostApp expr (sum by (job) (postfix_size{cluster=~\"$cluster|\", job=~\".+\"})) mappings - text: '-' type: 1 value: -1 message HostApp {{ $labels.job }}: Postfix Queue Size High {{ $value }}% name HostAppPostfixQueueSizeHigh thresholds critical: 10 lowest: 0 operator: '>=' warning: 5 panel Property Value expr (sum by (job) (postfix_size{cluster=~\"$cluster|\", %(job)s})) OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 10 lowest: 0 operator: '>=' warning: 5 unit mailq pythonFlask Property Value alert alert default False panel panel alert Property Value customLables alertgroup: HostApp expr (sum by (job) (rate(flask_http_request_duration_seconds_count{cluster=~\"$cluster|\", job=~\".+\",status!~\"[4-5].*\"}[5m])) / sum by (job) (rate(flask_http_request_duration_seconds_count{cluster=~\"$cluster|\", job=~\".+\"}[5m])) * 100) > 0 OR (sum by (job) (rate(flask_http_request_duration_seconds_count{cluster=~\"$cluster|\", job=~\".+\"}[5m])) + 100) message HostApp {{ $labels.job }}: Python Flask Success Rate (non-4|5xx responses) Low {{ $value }}% name HostAppPythonFlaskSuccessRateLow thresholds critical: 85 lowest: 0 operator: < warning: 95 panel Property Value expr (sum by (job) (rate(flask_http_request_duration_seconds_count{cluster=~\"$cluster|\", %(job)s,status!~\"[4-5].*\"}[5m])) / sum by (job) (rate(flask_http_request_duration_seconds_count{cluster=~\"$cluster|\", %(job)s}[5m])) * 100) > 0 OR (sum by (job) (rate(flask_http_request_duration_seconds_count{cluster=~\"$cluster|\", %(job)s}[5m])) + 100) OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 85 lowest: 0 operator: < warning: 95 rabbitmq Property Value alert {} default False panel panel panel Property Value expr (sum(up{%(job)s}) / count(up{cluster=~\"$cluster|\", %(job)s}))*100 OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 95 lowest: 0 operator: < warning: 99 k8s Property Value apiServerHealth apiServerHealth controllerManagerHealth controllerManagerHealth daemonSetsHealth daemonSetsHealth deploymentsHealth deploymentsHealth etcdHealth etcdHealth kubeletHealth kubeletHealth mostUtilizedNodeCPU mostUtilizedNodeCPU mostUtilizedNodeDisk mostUtilizedNodeDisk mostUtilizedNodeNetworkErrors mostUtilizedNodeNetworkErrors mostUtilizedNodeRAM mostUtilizedNodeRAM mostUtilizedPVC mostUtilizedPVC nodeHealth nodeHealth overallNetworkErrors overallNetworkErrors overallUtilizationCPU overallUtilizationCPU overallUtilizationDisk overallUtilizationDisk overallUtilizationRAM overallUtilizationRAM proxyHealth proxyHealth pvcBound pvcBound runningContainers runningContainers runningPods runningPods runningStatefulSets runningStatefulSets schedulerHealth schedulerHealth succeededJobs succeededJobs targetDown targetDown totalCores totalCores totalDisk totalDisk totalRAM totalRAM usedCores usedCores usedDisk usedDisk usedRAM usedRAM apiServerHealth Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr (sum(up{cluster=~\"$cluster|\", job=\"apiserver\"}) / count(up{cluster=~\"$cluster|\", job=\"apiserver\"})) * 100 message Cluster Api Server Health Low {{ $value }}% name ClusterApiServerHealthLow thresholds critical: 95 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/apiserver?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr (sum(up{cluster=~\"$cluster|\", job=\"apiserver\"}) / count(up{cluster=~\"$cluster|\", job=\"apiserver\"})) * 100 gridPos w: 4 x: 0 y: 12 thresholds critical: 95 operator: < warning: 99 title API Server controllerManagerHealth Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr (sum(up{cluster=~\"$cluster|\", job=\"kube-controller-manager\"}) / count(up{cluster=~\"$cluster|\", job=\"kube-controller-manager\"})) * 100 message Cluster Controller Manager Health Low {{ $value }}% name ClusterControllerManagerHealthLow thresholds critical: 95 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/controllermanager?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr (sum(up{cluster=~\"$cluster|\", job=\"kube-controller-manager\"}) / count(up{cluster=~\"$cluster|\", job=\"kube-controller-manager\"})) * 100 gridPos w: 4 x: 4 y: 12 thresholds critical: 95 operator: < warning: 99 title Controller Manager daemonSetsHealth Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr round((sum(kube_daemonset_updated_number_scheduled{cluster=~\"$cluster|\"}) + sum(kube_daemonset_status_number_available{cluster=~\"$cluster|\"})) / (2 * sum(kube_daemonset_status_desired_number_scheduled{cluster=~\"$cluster|\"})) * 100) message DaemonSets Health Low {{ $value }}% name RunningDaemonSetsHealthLow thresholds critical: 95 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/daemonsetoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr round((sum(kube_daemonset_updated_number_scheduled{cluster=~\"$cluster|\"}) + sum(kube_daemonset_status_number_available{cluster=~\"$cluster|\"})) / (2 * sum(kube_daemonset_status_desired_number_scheduled{cluster=~\"$cluster|\"})) * 100) gridPos x: 6 y: 8 thresholds critical: 95 operator: < warning: 99 title DaemonSets Health deploymentsHealth Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr round((sum(kube_deployment_status_replicas_updated{cluster=~\"$cluster|\"}) + sum(kube_deployment_status_replicas_available{cluster=~\"$cluster|\"})) / (2 * sum(kube_deployment_status_replicas{cluster=~\"$cluster|\"})) * 100) message Running Deployments Health Low {{ $value }}% name RunningDeploymentsHealthLow thresholds critical: 95 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/deploymentoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr round((sum(kube_deployment_status_replicas_updated{cluster=~\"$cluster|\"}) + sum(kube_deployment_status_replicas_available{cluster=~\"$cluster|\"})) / (2 * sum(kube_deployment_status_replicas{cluster=~\"$cluster|\"})) * 100) gridPos x: 0 y: 8 thresholds critical: 95 operator: < warning: 99 title Deployments Health etcdHealth Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr (sum(up{cluster=~\"$cluster|\", job=\"kube-etcd\"}) / count(up{cluster=~\"$cluster|\", job=\"kube-etcd\"})) * 100 message Cluster Etcd Health Low {{ $value }}% name ClusterEtcdHealthLow thresholds critical: 95 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/etcd?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr (sum(up{cluster=~\"$cluster|\", job=\"kube-etcd\"}) / count(up{cluster=~\"$cluster|\", job=\"kube-etcd\"})) * 100 gridPos w: 4 x: 8 y: 12 thresholds critical: 95 operator: < warning: 99 title Etcd kubeletHealth Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr (sum(up{cluster=~\"$cluster|\", job=\"kubelet\", metrics_path=\"/metrics\"}) / count(up{cluster=~\"$cluster|\", job=\"kubelet\", metrics_path=\"/metrics\"})) * 100 message Cluster Kubelet Health Low {{ $value }}% name ClusterKubeletHealthLow thresholds critical: 95 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/kubelet?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr (sum(up{cluster=~\"$cluster|\", job=\"kubelet\", metrics_path=\"/metrics\"}) / count(up{cluster=~\"$cluster|\", job=\"kubelet\", metrics_path=\"/metrics\"})) * 100 gridPos w: 4 x: 12 y: 12 thresholds critical: 95 operator: < warning: 99 title Kubelet mostUtilizedNodeCPU Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr round((1 - (avg(irate(node_cpu_seconds_total{cluster=~\"$cluster|\", job=~\"node-exporter\", mode=\"idle\"}[5m]) * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename) )) * 100) message Cluster {{ $labels.nodename }}: High CPU Utilization {{ $value }}% name ClusterNodeCPUUtilizationHigh thresholds critical: 90 operator: '>=' warning: 75 panel Property Value dataLinks - title: System Overview url: /d/cpuoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to&var-instance=All - title: K8s Overview url: /d/cpunamespaceoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr max(round((1 - (avg(irate(node_cpu_seconds_total{cluster=~\"$cluster|\", job=~\"$job\", mode=\"idle\"}[5m]) * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename) )) * 100)) gridPos w: 3 x: 3 y: 17 thresholds critical: 90 operator: '>=' warning: 75 title Most Utilized Node mostUtilizedNodeDisk Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr round((sum(node_filesystem_size_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) / ((sum(node_filesystem_size_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) + sum(node_filesystem_avail_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) * 100) message Cluster node {{ $labels.nodename }}: High Disk Utilization {{ $value }}% name ClusterHostDiskUtilizationHigh thresholds critical: 90 operator: '>=' warning: 75 panel Property Value dataLinks - title: System Overview url: /d/diskoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to&var-instance=All description The percentage of the disk utilization is calculated using the fraction: <space used>/(<space used> + <space free>) The value of is reduced by 5% of the available disk capacity, because the file system marks 5% of the available disk capacity as reserved. If less than 5% is free, using the remaining reserved space requires root privileges. Any non-privileged users and processes are unable to write new data to the partition. See the list of explicitly ignored mount points and file systems [here](https://github.com/dNationCloud/kubernetes-monitoring-stack/blob/main/chart/values.yaml) expr max(round((sum(node_filesystem_size_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) / ((sum(node_filesystem_size_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) + sum(node_filesystem_avail_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) * 100)) gridPos w: 3 x: 15 y: 17 thresholds critical: 90 operator: '>=' warning: 75 title Most Utilized Node mostUtilizedNodeNetworkErrors Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr sum(rate(node_network_transmit_errs_total{cluster=~\"$cluster|\", job=~\"node-exporter\", device!~\"lo|veth.+|docker.+|flannel.+|cali.+|cbr.|cni.+|br.+\"} [5m]) * on(instance) group_left(nodename) (node_uname_info) ) by (job, nodename) + sum(rate(node_network_receive_errs_total{cluster=~\"$cluster|\", job=~\"node-exporter\", device!~\"lo|veth.+|docker.+|flannel.+|cali.+|cbr.|cni.+|br.+\"}[5m]) * on(instance) group_left(nodename) (node_uname_info) ) by (job, nodename) message Cluster node {{ $labels.nodename }}: High Network Errors Count {{ $value }}% name ClusterHostNetworkErrorsHigh thresholds critical: 15 operator: '>=' warning: 10 panel Property Value dataLinks - title: System Overview url: /d/networkoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to&var-instance=All - title: K8s Overview url: /d/networknamespaceoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr max(sum(rate(node_network_transmit_errs_total{cluster=~\"$cluster|\", job=~\"$job\", device!~\"lo|veth.+|docker.+|flannel.+|cali.+|cbr.|cni.+|br.+\"} [5m]) * on(instance) group_left(nodename) (node_uname_info) ) by (job, nodename) + sum(rate(node_network_receive_errs_total{cluster=~\"$cluster|\", job=~\"$job\", device!~\"lo|veth.+|docker.+|flannel.+|cali.+|cbr.|cni.+|br.+\"}[5m]) * on(instance) group_left(nodename) (node_uname_info) ) by (job, nodename)) gridPos w: 3 x: 21 y: 17 thresholds critical: 15 operator: '>=' warning: 10 title Most Affected Node unit pps mostUtilizedNodeRAM Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr round((1 - sum by (job, nodename) (node_memory_MemAvailable_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) / sum by (job, nodename) (node_memory_MemTotal_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info))) * 100) message Cluster node {{ $labels.nodename }}: High RAM Utilization {{ $value }}% name ClusterNodesRAMUtilizationHigh thresholds critical: 90 operator: '>=' warning: 75 panel Property Value dataLinks - title: System Overview url: /d/memoryoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to&var-instance=All - title: K8s Overview url: /d/memorynamespaceoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to description The percentage of the memory utilization is calculated by: 1 - (<memory available>/<memory total>) expr max(round((1 - sum by (job, nodename) (node_memory_MemAvailable_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) / sum by (job, nodename) (node_memory_MemTotal_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info))) * 100)) gridPos w: 3 x: 9 y: 17 thresholds critical: 90 operator: '>=' warning: 75 title Most Utilized Node mostUtilizedPVC Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr sum(((kubelet_volume_stats_capacity_bytes{cluster=~\"$cluster|\"} - kubelet_volume_stats_available_bytes{cluster=~\"$cluster|\"}) / kubelet_volume_stats_capacity_bytes{cluster=~\"$cluster|\"}) * 100) by (persistentvolumeclaim) message \"{{ $labels.persistentvolumeclaim }}\": High PVC Utilization {{ $value }}% name PVCUtilizationHigh thresholds critical: 97 lowest: 0 operator: '>=' warning: 85 panel Property Value dataLinks - title: K8s Overview url: /d/pvcoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr max(sum(((kubelet_volume_stats_capacity_bytes{cluster=~\"$cluster|\"} - kubelet_volume_stats_available_bytes{cluster=~\"$cluster|\"}) / kubelet_volume_stats_capacity_bytes{cluster=~\"$cluster|\"}) * 100) by (persistentvolumeclaim)) OR on() vector(-1) gridPos w: 3 x: 21 y: 8 mappings - text: '-' type: 1 value: -1 thresholds critical: 97 lowest: 0 operator: '>=' warning: 85 title Most Utilized PVC nodeHealth Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr round(sum(kube_node_info{cluster=~\"$cluster|\"}) / (sum(kube_node_info{cluster=~\"$cluster|\"}) + sum(kube_node_spec_unschedulable{cluster=~\"$cluster|\"}) + sum(kube_node_status_condition{cluster=~\"$cluster|\", condition=~\"DiskPressure|MemoryPressure|PIDPressure\", status=~\"true|unknown\"}) + sum(kube_node_status_condition{cluster=~\"$cluster|\", condition=\"Ready\", status=~\"false|unknown\"}) ) * 100) message \"{{ $labels.node }}\": Node Health Low {{ $value }}% name NodesHealthLow thresholds critical: 95 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/nodeoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr avg(round(sum(kube_node_info{cluster=~\"$cluster|\"}) / (sum(kube_node_info{cluster=~\"$cluster|\"}) + sum(kube_node_spec_unschedulable{cluster=~\"$cluster|\"}) + sum(kube_node_status_condition{cluster=~\"$cluster|\", condition=~\"DiskPressure|MemoryPressure|PIDPressure\", status=~\"true|unknown\"}) + sum(kube_node_status_condition{cluster=~\"$cluster|\", condition=\"Ready\", status=~\"false|unknown\"}) ) * 100)) gridPos x: 0 y: 5 thresholds critical: 95 operator: < warning: 99 title Nodes Health overallNetworkErrors Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr sum(sum(rate(node_network_transmit_errs_total{cluster=~\"$cluster|\", job=~\"node-exporter\", device!~\"lo|veth.+|docker.+|flannel.+|cali.+|cbr.|cni.+|br.+\"} [5m]) * on(instance) group_left(nodename) (node_uname_info) ) by (job, nodename) + sum(rate(node_network_receive_errs_total{cluster=~\"$cluster|\", job=~\"node-exporter\", device!~\"lo|veth.+|docker.+|flannel.+|cali.+|cbr.|cni.+|br.+\"}[5m]) * on(instance) group_left(nodename) (node_uname_info) ) by (job, nodename)) message Cluster High Overall Network Errors Count {{ $value }}% name ClusterNetworkOverallErrorsHigh thresholds critical: 15 operator: '>=' warning: 10 panel Property Value dataLinks - title: System Overview url: /d/networkoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to&var-instance=All - title: K8s Overview url: /d/networknamespaceoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr sum(sum(rate(node_network_transmit_errs_total{cluster=~\"$cluster|\", job=~\"$job\", device!~\"lo|veth.+|docker.+|flannel.+|cali.+|cbr.|cni.+|br.+\"} [5m]) * on(instance) group_left(nodename) (node_uname_info) ) by (job, nodename) + sum(rate(node_network_receive_errs_total{cluster=~\"$cluster|\", job=~\"$job\", device!~\"lo|veth.+|docker.+|flannel.+|cali.+|cbr.|cni.+|br.+\"}[5m]) * on(instance) group_left(nodename) (node_uname_info) ) by (job, nodename)) gridPos w: 3 x: 18 y: 17 thresholds critical: 15 operator: '>=' warning: 10 title Overall Errors unit pps overallUtilizationCPU Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr avg(round((1 - (avg(irate(node_cpu_seconds_total{cluster=~\"$cluster|\", job=~\"node-exporter\", mode=\"idle\"}[5m]) * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename) )) * 100)) message Cluster High CPU Overall Utilization {{ $value }}% name ClusterCPUOverallHigh thresholds critical: 90 operator: '>=' warning: 75 panel Property Value dataLinks - title: System Overview url: /d/cpuoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to&var-instance=All - title: K8s Overview url: /d/cpunamespaceoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr avg(round((1 - (avg(irate(node_cpu_seconds_total{cluster=~\"$cluster|\", job=~\"$job\", mode=\"idle\"}[5m]) * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename) )) * 100)) gridPos w: 3 x: 0 y: 17 thresholds critical: 90 operator: '>=' warning: 75 title Overall Utilization overallUtilizationDisk Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr avg(round((sum(node_filesystem_size_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) / ((sum(node_filesystem_size_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) + sum(node_filesystem_avail_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) * 100 > 0)) message Cluster High Disk Overall Utilization {{ $value }}% name ClusterDiskOverallHigh thresholds critical: 90 operator: '>=' warning: 75 panel Property Value dataLinks - title: System Overview url: /d/diskoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to&var-instance=All description The percentage of the disk utilization is calculated using the fraction: <space used>/(<space used> + <space free>) The value of is reduced by 5% of the available disk capacity, because the file system marks 5% of the available disk capacity as reserved. If less than 5% is free, using the remaining reserved space requires root privileges. Any non-privileged users and processes are unable to write new data to the partition. See the list of explicitly ignored mount points and file systems [here](https://github.com/dNationCloud/kubernetes-monitoring-stack/blob/main/chart/values.yaml) expr avg(round((sum(node_filesystem_size_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) / ((sum(node_filesystem_size_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) + sum(node_filesystem_avail_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) * 100 > 0)) gridPos w: 3 x: 12 y: 17 thresholds critical: 90 operator: '>=' warning: 75 title Overall Utilization overallUtilizationRAM Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr avg(round((1 - sum by (job, nodename) (node_memory_MemAvailable_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) / sum by (job, nodename) (node_memory_MemTotal_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info))) * 100)) message Cluster High RAM Overall Utilization {{ $value }}% name ClusterRAMOverallHigh thresholds critical: 90 operator: '>=' warning: 75 panel Property Value dataLinks - title: System Overview url: /d/memoryoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to&var-instance=All - title: K8s Overview url: /d/memorynamespaceoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to description The percentage of the memory utilization is calculated by: 1 - (<memory available>/<memory total>) expr avg(round((1 - sum by (job, nodename) (node_memory_MemAvailable_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) / sum by (job, nodename) (node_memory_MemTotal_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info))) * 100)) gridPos w: 3 x: 6 y: 17 thresholds critical: 90 operator: '>=' warning: 75 title Overall Utilization proxyHealth Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr (sum(up{cluster=~\"$cluster|\", job=\"kube-proxy\"}) / count(up{cluster=~\"$cluster|\", job=\"kube-proxy\"})) * 100 message Cluster Proxy Health Low {{ $value }}% name ClusterProxyHealthLow thresholds critical: 95 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/proxy?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr (sum(up{cluster=~\"$cluster|\", job=\"kube-proxy\"}) / count(up{cluster=~\"$cluster|\", job=\"kube-proxy\"})) * 100 gridPos w: 4 x: 16 y: 12 thresholds critical: 95 operator: < warning: 99 title Proxy pvcBound Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr round(sum(kube_persistentvolumeclaim_status_phase{cluster=~\"$cluster|\", phase=\"Bound\"}) / ( sum(kube_persistentvolumeclaim_status_phase{cluster=~\"$cluster|\", phase=\"Bound\"}) + sum(kube_persistentvolumeclaim_status_phase{cluster=~\"$cluster|\", phase=\"Pending\"}) + sum(kube_persistentvolumeclaim_status_phase{cluster=~\"$cluster|\", phase=\"Lost\"}) ) * 100) message PVC Bound Rate Low {{ $value }}% name PVCBoundRateLow thresholds critical: 95 lowest: 0 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/pvcoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr round(sum(kube_persistentvolumeclaim_status_phase{cluster=~\"$cluster|\", phase=\"Bound\"}) / ( sum(kube_persistentvolumeclaim_status_phase{cluster=~\"$cluster|\", phase=\"Bound\"}) + sum(kube_persistentvolumeclaim_status_phase{cluster=~\"$cluster|\", phase=\"Pending\"}) + sum(kube_persistentvolumeclaim_status_phase{cluster=~\"$cluster|\", phase=\"Lost\"}) ) * 100) OR on() vector(-1) gridPos w: 3 x: 18 y: 8 mappings - text: '-' type: 1 value: -1 thresholds critical: 95 lowest: 0 operator: < warning: 99 title PVC Bound runningContainers Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr round(sum(kube_pod_container_status_running{cluster=~\"$cluster|\"}) / (sum(kube_pod_container_status_running{cluster=~\"$cluster|\"}) + sum(kube_pod_container_status_terminated_reason{cluster=~\"$cluster|\", reason!=\"Completed\"}) + sum(kube_pod_container_status_waiting{cluster=~\"$cluster|\"})) * 100) message Running Containers Health Low {{ $value }}% name RunningContainersHealthLow thresholds critical: 95 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/containeroverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr round(sum(kube_pod_container_status_running{cluster=~\"$cluster|\"}) / (sum(kube_pod_container_status_running{cluster=~\"$cluster|\"}) + sum(kube_pod_container_status_terminated_reason{cluster=~\"$cluster|\", reason!=\"Completed\"}) + sum(kube_pod_container_status_waiting{cluster=~\"$cluster|\"})) * 100) gridPos x: 12 y: 8 thresholds critical: 95 operator: < warning: 99 title Running Containers runningPods Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr round(sum(kube_pod_status_phase{cluster=~\"$cluster|\", phase=\"Running\"}) / (sum(kube_pod_status_phase{cluster=~\"$cluster|\", phase=\"Running\"}) + sum(kube_pod_status_phase{cluster=~\"$cluster|\", phase=\"Pending\"}) + sum(kube_pod_status_phase{cluster=~\"$cluster|\", phase=\"Failed\"}) + sum(kube_pod_status_phase{cluster=~\"$cluster|\", phase=\"Unknown\"})) * 100) message Pods Health Low {{ $value }}% name RunningPodsHealthLow thresholds critical: 95 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/podoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr round(sum(kube_pod_status_phase{cluster=~\"$cluster|\", phase=\"Running\"}) / (sum(kube_pod_status_phase{cluster=~\"$cluster|\", phase=\"Running\"}) + sum(kube_pod_status_phase{cluster=~\"$cluster|\", phase=\"Pending\"}) + sum(kube_pod_status_phase{cluster=~\"$cluster|\", phase=\"Failed\"}) + sum(kube_pod_status_phase{cluster=~\"$cluster|\", phase=\"Unknown\"})) * 100) gridPos x: 12 y: 5 thresholds critical: 95 operator: < warning: 99 title Running Pods runningStatefulSets Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr round(sum(kube_statefulset_status_replicas_ready{cluster=~\"$cluster|\"}) / sum(kube_statefulset_status_replicas{cluster=~\"$cluster|\"}) * 100) message StatefulSets Health Low {{ $value }}% name RunningStatefulSetsHealthLow thresholds critical: 95 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/statefulsetoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr round(sum(kube_statefulset_status_replicas_ready{cluster=~\"$cluster|\"}) / sum(kube_statefulset_status_replicas{cluster=~\"$cluster|\"}) * 100) gridPos x: 6 y: 5 thresholds critical: 95 operator: < warning: 99 title Running StatefulSets schedulerHealth Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr (sum(up{cluster=~\"$cluster|\", job=\"kube-scheduler\"}) / count(up{cluster=~\"$cluster|\", job=\"kube-scheduler\"})) * 100 message Cluster Scheduler Health Low {{ $value }}% name ClusterSchedulerHealthLow thresholds critical: 95 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/scheduler?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr (sum(up{cluster=~\"$cluster|\", job=\"kube-scheduler\"}) / count(up{cluster=~\"$cluster|\", job=\"kube-scheduler\"})) * 100 gridPos w: 4 x: 20 y: 12 thresholds critical: 95 operator: < warning: 99 title Scheduler succeededJobs Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr round(sum(kube_job_status_succeeded{cluster=~\"$cluster|\"}) / (sum(kube_job_status_succeeded{cluster=~\"$cluster|\"}) + sum(kube_job_status_failed{cluster=~\"$cluster|\"})) * 100) message Succeeded Jobs Rate Low {{ $value }}% name SucceededJobsRateLow thresholds critical: 95 lowest: 0 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/joboverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr round(sum(kube_job_status_succeeded{cluster=~\"$cluster|\"}) / (sum(kube_job_status_succeeded{cluster=~\"$cluster|\"}) + sum(kube_job_status_failed{cluster=~\"$cluster|\"})) * 100) OR on() vector(-1) gridPos x: 18 y: 5 mappings - text: '-' type: 1 value: -1 thresholds critical: 95 lowest: 0 operator: < warning: 99 title Succeeded Jobs targetDown Property Value alert alert panel None alert Property Value customLables alertgroup: Cluster expr 100 * (count by(job, namespace, service) (up{alertGroup!=\"Host\"} == 0) / count by(job, namespace, service) (up{alertGroup!=\"Host\"})) message {{ printf \"%.4g\" $value }}% of the {{ $labels.job }}/{{ $labels.service }} targets in {{ $labels.namespace }} namespace are down. name ClusterTargetDown thresholds critical: 90 operator: '>=' warning: 10 totalCores Property Value panel panel panel Property Value colorMode value expr count(node_cpu_seconds_total{cluster=~\"$cluster\", job=~\"$job\", mode=\"system\"}) graphMode none gridPos h: 2 w: 3 x: 3 y: 20 thresholds color: '#ffffff' value: title Total Cores unit none totalDisk Property Value panel panel panel Property Value colorMode value expr sum(node_filesystem_size_bytes{cluster=~\"$cluster\", job=~\"$job\"}) graphMode none gridPos h: 2 w: 3 x: 15 y: 20 thresholds color: '#ffffff' value: title Total unit bytes totalRAM Property Value panel panel panel Property Value colorMode value expr sum(node_memory_MemTotal_bytes{cluster=~\"$cluster\", job=~\"$job\"}) graphMode none gridPos h: 2 w: 3 x: 9 y: 20 thresholds color: '#ffffff' value: title Total unit bytes usedCores Property Value panel panel panel Property Value colorMode value expr (1 - (avg(irate(node_cpu_seconds_total{cluster=~\"$cluster\", job=~\"$job\", mode=\"idle\"}[5m])))) * count(node_cpu_seconds_total{cluster=~\"$cluster\", job=~\"$job\", mode=\"system\"}) graphMode none gridPos h: 2 w: 3 x: 0 y: 20 thresholds color: '#ffffff' value: title Used Cores unit none usedDisk Property Value panel panel panel Property Value colorMode value expr sum(node_filesystem_size_bytes{cluster=~\"$cluster\", job=~\"$job\"}) * (( avg( (sum(node_filesystem_size_bytes{cluster=~\"$cluster\", job=~\"$job\"}) by (device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster\", job=~\"$job\"}) by (device)) / (sum(node_filesystem_size_bytes{cluster=~\"$cluster\", job=~\"$job\"}) by (device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster\", job=~\"$job\"}) by (device) + sum(node_filesystem_avail_bytes{cluster=~\"$cluster\", job=~\"$job\"}) by (device)) > 0 ))) graphMode none gridPos h: 2 w: 3 x: 12 y: 20 thresholds color: '#ffffff' value: title Used unit bytes usedRAM Property Value panel panel panel Property Value colorMode value expr sum(node_memory_MemTotal_bytes{cluster=~\"$cluster\", job=~\"$job\"}) * (((1 - sum(node_memory_MemAvailable_bytes{cluster=~\"$cluster\", job=~\"$job\"}) / sum(node_memory_MemTotal_bytes{cluster=~\"$cluster\", job=~\"$job\"})))) graphMode none gridPos h: 2 w: 3 x: 6 y: 20 thresholds color: '#ffffff' value: title Used unit bytes k8sApps Property Value apache apache autoscaler autoscaler cAdvisor cAdvisor genericApp genericApp javaActuator javaActuator nginxIngress nginxIngress nginxNrpe nginxNrpe nginxVts nginxVts phpFpm phpFpm postfix postfix pythonFlask pythonFlask rabbitmq rabbitmq apache Property Value alert {} default False panel panel panel Property Value expr (sum(up{%(job)s}) / count(up{cluster=~\"$cluster|\", %(job)s}))*100 OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 95 lowest: 0 operator: < warning: 99 autoscaler Property Value alert alert default False panel panel alert Property Value customLables alertgroup: ClusterApp expr (sum by (job) (autoscaler_healthy{cluster=~\"$cluster|\", job=~\".+\"}) / sum by (job) (autoscaler_instances{cluster=~\"$cluster|\", job=~\".+\"}) * 100) message ClusterApp {{ $labels.job }}: Autoscaler Health Low {{ $value }}% name ClusterAppAutoscalerHealthLow thresholds critical: 85 lowest: 0 operator: < warning: 95 panel Property Value expr (sum by (job) (autoscaler_healthy{cluster=~\"$cluster|\", %(job)s}) / sum by (job) (autoscaler_instances{cluster=~\"$cluster|\", %(job)s}) * 100) OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 85 lowest: 0 operator: < warning: 95 cAdvisor Property Value alert {} default False panel panel panel Property Value expr (sum(up{%(job)s}) / count(up{cluster=~\"$cluster|\", %(job)s}))*100 OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 95 lowest: 0 operator: < warning: 99 genericApp Property Value alert {} default False panel panel panel Property Value description GenericApp template. Used when application monitoring is requested but appropriate template was not found. expr (sum(up{%(job)s}) / count(up{cluster=~\"$cluster|\", %(job)s}))*100 gridPos w: 4 thresholds critical: 95 operator: < warning: 99 javaActuator Property Value alert alert default False panel panel alert Property Value customLables alertgroup: ClusterApp expr (sum by (job) (jvm_memory_used_bytes{cluster=~\"$cluster|\", job=~\".+\", area=\"heap\"})*100/sum by (job) (jvm_memory_max_bytes{cluster=~\"$cluster|\", job=~\".+\", area=\"nonheap\"}) > sum by (job) (jvm_memory_used_bytes{cluster=~\"$cluster|\", job=~\".+\", area=\"nonheap\"})*100/sum by (job) (jvm_memory_max_bytes{cluster=~\"$cluster|\", job=~\".+\", area=\"heap\"}) or (sum by (job) (jvm_memory_used_bytes{cluster=~\"$cluster|\", job=~\".+\", area=\"nonheap\"})*100)/sum by (job) (jvm_memory_max_bytes{cluster=~\"$cluster|\", job=~\".+\", area=\"heap\"})) message ClusterApp {{ $labels.job }}: Java Actuator Heap High {{ $value }}% name ClusterAppJavaActuatorHeapHigh thresholds critical: 90 lowest: 0 operator: '>=' warning: 75 panel Property Value expr (sum by (job) (jvm_memory_used_bytes{cluster=~\"$cluster|\", %(job)s, area=\"heap\"})*100/sum by (job) (jvm_memory_max_bytes{cluster=~\"$cluster|\", %(job)s, area=\"nonheap\"}) > sum by (job) (jvm_memory_used_bytes{cluster=~\"$cluster|\", %(job)s, area=\"nonheap\"})*100/sum by (job) (jvm_memory_max_bytes{cluster=~\"$cluster|\", %(job)s, area=\"heap\"}) or (sum by (job) (jvm_memory_used_bytes{cluster=~\"$cluster|\", %(job)s, area=\"nonheap\"})*100)/sum by (job) (jvm_memory_max_bytes{cluster=~\"$cluster|\", %(job)s, area=\"heap\"})) OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 90 lowest: 0 operator: '>=' warning: 75 nginxIngress Property Value alert alert default False panel panel alert Property Value customLables alertgroup: ClusterApp expr ((sum by (job) (rate(nginx_ingress_controller_requests{cluster=~\"$cluster|\", job=~\".+\", status!~\"[4-5].*\"}[5m])) / sum by (job) (rate(nginx_ingress_controller_requests{cluster=~\"$cluster|\", job=~\".+\"}[5m])) * 100) > 0 OR (sum by (job) (rate(nginx_ingress_controller_requests{cluster=~\"$cluster|\", job=~\".+\"}[5m])) + 100)) message ClusterApp {{ $labels.job }}: Nginx Ingress Success Rate (non-4|5xx responses) Low {{ $value }}% name ClusterAppNginxIngressSuccessRateLow thresholds critical: 85 lowest: 0 operator: < warning: 95 panel Property Value expr ((sum by (job) (rate(nginx_ingress_controller_requests{cluster=~\"$cluster|\", %(job)s, status!~\"[4-5].*\"}[5m])) / sum by (job) (rate(nginx_ingress_controller_requests{cluster=~\"$cluster|\", %(job)s}[5m])) * 100) > 0 OR (sum by (job) (rate(nginx_ingress_controller_requests{cluster=~\"$cluster|\", %(job)s}[5m])) + 100)) OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 85 lowest: 0 operator: < warning: 95 nginxNrpe Property Value alert {} default False panel panel panel Property Value expr (sum(up{%(job)s}) / count(up{cluster=~\"$cluster|\", %(job)s}))*100 OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 95 lowest: 0 operator: < warning: 99 nginxVts Property Value alert alert default False panel panel alert Property Value customLables alertgroup: ClusterApp expr (sum by (job) (rate(nginx_server_requests{cluster=~\"$cluster|\", job=~\".+\", code!~\"[4-5].*\", code!=\"total\"}[5m])) / sum by (job) (rate(nginx_server_requests{cluster=~\"$cluster|\", job=~\".+\", code!=\"total\"}[5m])) * 100) > 0 OR (sum by (job) (rate(nginx_server_requests{cluster=~\"$cluster|\", job=~\".+\"}[5m])) + 100) message ClusterApp {{ $labels.job }}: Nginx VTS Success Rate (non-4|5xx responses) Low {{ $value }}% name ClusterAppNginxVTSSuccessRateLow thresholds critical: 85 lowest: 0 operator: < warning: 95 panel Property Value expr (sum by (job) (rate(nginx_server_requests{cluster=~\"$cluster|\", %(job)s, code!~\"[4-5].*\", code!=\"total\"}[5m])) / sum by (job) (rate(nginx_server_requests{cluster=~\"$cluster|\", %(job)s, code!=\"total\"}[5m])) * 100) > 0 OR (sum by (job) (rate(nginx_server_requests{cluster=~\"$cluster|\", %(job)s}[5m])) + 100) OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 85 lowest: 0 operator: < warning: 95 phpFpm Property Value alert {} default False panel panel panel Property Value expr (sum(up{%(job)s}) / count(up{cluster=~\"$cluster|\", %(job)s}))*100 OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 95 lowest: 0 operator: < warning: 99 postfix Property Value alert alert default False panel panel alert Property Value customLables alertgroup: ClusterApp expr (sum by (job) (postfix_size{cluster=~\"$cluster|\", job=~\".+\"})) mappings - text: '-' type: 1 value: -1 message ClusterApp {{ $labels.job }}: Postfix Queue Size High {{ $value }}% name ClusterAppPostfixQueueSizeHigh thresholds critical: 10 lowest: 0 operator: '>=' warning: 5 panel Property Value expr (sum by (job) (postfix_size{cluster=~\"$cluster|\", %(job)s})) OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 10 lowest: 0 operator: '>=' warning: 5 unit mailq pythonFlask Property Value alert alert default False panel panel alert Property Value customLables alertgroup: ClusterApp expr (sum by (job) (rate(flask_http_request_duration_seconds_count{cluster=~\"$cluster|\", job=~\".+\",status!~\"[4-5].*\"}[5m])) / sum by (job) (rate(flask_http_request_duration_seconds_count{cluster=~\"$cluster|\", job=~\".+\"}[5m])) * 100) > 0 OR (sum by (job) (rate(flask_http_request_duration_seconds_count{cluster=~\"$cluster|\", job=~\".+\"}[5m])) + 100) message ClusterApp {{ $labels.job }}: Python Flask Success Rate (non-4|5xx responses) Low {{ $value }}% name ClusterAppPythonFlaskSuccessRateLow thresholds critical: 85 lowest: 0 operator: < warning: 95 panel Property Value expr (sum by (job) (rate(flask_http_request_duration_seconds_count{cluster=~\"$cluster|\", %(job)s,status!~\"[4-5].*\"}[5m])) / sum by (job) (rate(flask_http_request_duration_seconds_count{cluster=~\"$cluster|\", %(job)s}[5m])) * 100) > 0 OR (sum by (job) (rate(flask_http_request_duration_seconds_count{cluster=~\"$cluster|\", %(job)s}[5m])) + 100) OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 85 lowest: 0 operator: < warning: 95 rabbitmq Property Value alert {} default False panel panel panel Property Value expr (sum(up{%(job)s}) / count(up{cluster=~\"$cluster|\", %(job)s}))*100 OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 95 lowest: 0 operator: < warning: 99","title":"Docs"},{"location":"docs/documentation/#dnation-kubernetes-monitoring-docs","text":"This is generated documentation from configuration files of Kubernetes Monitoring . Each configuration parameter can be overriden by providing custom values.yaml during helm installation. Property Value clusterMonitoring clusterMonitoring commonLabels {} dnation-kubernetes-jsonnet-translator dnation-kubernetes-jsonnet-translator fullnameOverride grafanaDashboards grafanaDashboards hostMonitoring hostMonitoring nameOverride namespaceOverride prometheusRules prometheusRules templates templates","title":"dnation Kubernetes Monitoring Docs"},{"location":"docs/documentation/#clustermonitoring","text":"Property Value clusters - apps: [] description: Kubernetes cluster monitoring name: K8sCluster enabled True","title":"clusterMonitoring"},{"location":"docs/documentation/#dnation-kubernetes-jsonnet-translator","text":"Property Value enabled True image image","title":"dnation-kubernetes-jsonnet-translator"},{"location":"docs/documentation/#image","text":"Property Value args - --libsonnet - https://github.com/grafana/grafonnet-lib/grafonnet@005390f0207ffa4a8ae0d1afb253b7585ff7beca - https://github.com/thelastpickle/grafonnet-polystat-panel@275a48de57afdac0d72219d82863d8ab8bd0e682","title":"image"},{"location":"docs/documentation/#grafanadashboards","text":"Property Value color color constants infinity: 999999999 dataLinkCommonArgs refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to editable True enable True ids ids isLoki True labelGrafana grafana_dashboard: '1' labelJsonnet grafana_dashboard_jsonnet: '1' refresh 10s selectors selectors severityColors severityColors tags tags templateRefresh time templateSort 5 time_from now-5m tooltip shared_crosshair","title":"grafanaDashboards"},{"location":"docs/documentation/#color","text":"Property Value black #000000 blue #5794f2 green #56a64b lightblue #8ab8ff orange #ff780a pink #fce2de purple #a352cc red #e02f44 white #ffffff yellow #fade2a","title":"color"},{"location":"docs/documentation/#ids","text":"Property Value alertClusterOverview alertclusteroverview alertHostOverview alerthostoverview apache apache apiServer apiserver autoscaler autoscaler cAdvisor cadvisor containerDetail containerdetail containerOverview containeroverview controllerManager controllermanager cpuNamespaceOverview cpunamespaceoverview cpuOverview cpuoverview daemonSetOverview daemonsetoverview deploymentOverview deploymentoverview diskOverview diskoverview etcd etcd hostMonitoring hostmonitoring javaActuator javaactuator jobOverview joboverview k8sMonitoring k8smonitoring kubelet kubelet memoryNamespaceOverview memorynamespaceoverview memoryOverview memoryoverview monitoring monitoring networkNamespaceOverview networknamespaceoverview networkOverview networkoverview nginxIngress nginxingress nginxNrpe nginxnrpe nginxVts nginxvts nodeExporter nodeexporter nodeOverview nodeoverview persistentVolumes persistentvolumes phpFpm phpfpm podOverview podoverview postfix postfix proxy proxy pvcOverview pvcoverview pythonFlask pythonflask rabbitmq rabbitmq scheduler scheduler statefulSet statefulset statefulSetOverview statefulsetoverview","title":"ids"},{"location":"docs/documentation/#selectors","text":"Property Value apiServer job=\"apiserver\" controllerManager job=\"kube-controller-manager\" etcd job=\"kube-etcd\" kubelet job=\"kubelet\" proxy job=\"kube-proxy\" scheduler job=\"kube-scheduler\"","title":"selectors"},{"location":"docs/documentation/#severitycolors","text":"Property Value critical red default green invalid black warning orange","title":"severityColors"},{"location":"docs/documentation/#tags","text":"Property Value k8sApps - k8s - app - L1 k8sAppsMain - k8s - app - L0 k8sContainer - k8s - container - L3 k8sHostsMain - k8s - host - L1 k8sMonitoring - k8s - monitoring - L1 k8sMonitoringMain - k8s - cluster - host - L0 k8sNodeExporter - k8s - nodeexporter - L3 k8sOverview - k8s - overview - L2 k8sPVC - k8s - pvc - L3 k8sStatefulSet - k8s - statefulset - L3 k8sSystem - k8s - system - L2","title":"tags"},{"location":"docs/documentation/#hostmonitoring","text":"Property Value enabled False hosts []","title":"hostMonitoring"},{"location":"docs/documentation/#prometheusrules","text":"Property Value alertGroupCluster Cluster alertGroupClusterApp ClusterApp alertGroupHost Host alertGroupHostApp HostApp alertInterval 5m alertNamePrefix KubernetesMonitoring enable True labelJsonnet prometheus_rule_jsonnet: '1' labelPrometheus prometheus_rule: '1'","title":"prometheusRules"},{"location":"docs/documentation/#templates","text":"Property Value baseStatsTemplate baseStatsTemplate commonThresholds commonThresholds host host hostApps hostApps k8s k8s k8sApps k8sApps","title":"templates"},{"location":"docs/documentation/#basestatstemplate","text":"Property Value alert {} default True enabled True panel panel","title":"baseStatsTemplate"},{"location":"docs/documentation/#panel","text":"Property Value colorMode background dataLinks [] datasource $datasource description expr graphMode area gridPos gridPos mappings [] thresholds {} title error must be overwritten unit percent gridPos Property Value h 3 w 6 x error must be overwritten y error must be overwritten","title":"panel"},{"location":"docs/documentation/#commonthresholds","text":"Property Value app app controlPlane controlPlane criticalPanel criticalPanel k8s k8s node node warningPanel warningPanel","title":"commonThresholds"},{"location":"docs/documentation/#app","text":"Property Value critical 95 operator < warning 99","title":"app"},{"location":"docs/documentation/#controlplane","text":"Property Value critical 95 operator < warning 99","title":"controlPlane"},{"location":"docs/documentation/#criticalpanel","text":"Property Value critical 1 operator >=","title":"criticalPanel"},{"location":"docs/documentation/#k8s","text":"Property Value critical 95 operator < warning 99","title":"k8s"},{"location":"docs/documentation/#node","text":"Property Value critical 90 operator >= warning 75","title":"node"},{"location":"docs/documentation/#warningpanel","text":"Property Value operator >= warning 1","title":"warningPanel"},{"location":"docs/documentation/#host","text":"Property Value overallNetworkErrors overallNetworkErrors overallUtilizationCPU overallUtilizationCPU overallUtilizationDisk overallUtilizationDisk overallUtilizationRAM overallUtilizationRAM targetDown targetDown totalCores totalCores totalDisk totalDisk totalRAM totalRAM usedCores usedCores usedDisk usedDisk usedRAM usedRAM","title":"host"},{"location":"docs/documentation/#overallnetworkerrors","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Host expr sum(rate(node_network_transmit_errs_total{cluster=~\"$cluster|\", job!~\"node-exporter\", device!~\"lo|veth.+|docker.+|flannel.+|cali.+|cbr.|cni.+|br.+\"} [5m]) * on(instance) group_left(nodename) (node_uname_info) ) by (job, nodename) + sum(rate(node_network_receive_errs_total{cluster=~\"$cluster|\", job!~\"node-exporter\", device!~\"lo|veth.+|docker.+|flannel.+|cali.+|cbr.|cni.+|br.+\"}[5m]) * on(instance) group_left(nodename) (node_uname_info) ) by (job, nodename) message Host {{ $labels.nodename }}: High Overall Network Errors Count {{ $value }}% name HostNetworkOverallErrorsHigh thresholds critical: 15 operator: '>=' warning: 10 panel Property Value dataLinks - title: System Overview url: /d/nodeexporter?var-job=$job&refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr sum(rate(node_network_transmit_errs_total{cluster=~\"$cluster|\", job=~\"$job\", device!~\"lo|veth.+|docker.+|flannel.+|cali.+|cbr.|cni.+|br.+\"} [5m]) * on(instance) group_left(nodename) (node_uname_info) ) by (job, nodename) + sum(rate(node_network_receive_errs_total{cluster=~\"$cluster|\", job=~\"$job\", device!~\"lo|veth.+|docker.+|flannel.+|cali.+|cbr.|cni.+|br.+\"}[5m]) * on(instance) group_left(nodename) (node_uname_info) ) by (job, nodename) gridPos x: 18 y: 6 thresholds critical: 15 operator: '>=' warning: 10 title Overall Errors unit pps","title":"overallNetworkErrors"},{"location":"docs/documentation/#overallutilizationcpu","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Host expr round((1 - (avg(irate(node_cpu_seconds_total{cluster=~\"$cluster|\", job!~\"node-exporter\", mode=\"idle\"}[5m]) * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename) )) * 100) message Host {{ $labels.nodename }}: High CPU Overall Utilization {{ $value }}% name HostCPUOverallHigh thresholds critical: 90 operator: '>=' warning: 75 panel Property Value dataLinks - title: System Overview url: /d/nodeexporter?var-job=$job&refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr avg(round((1 - (avg(irate(node_cpu_seconds_total{cluster=~\"$cluster|\", job=~\"$job\", mode=\"idle\"}[5m]) * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename) )) * 100)) gridPos x: 0 y: 6 thresholds critical: 90 operator: '>=' warning: 75 title Overall Utilization","title":"overallUtilizationCPU"},{"location":"docs/documentation/#overallutilizationdisk","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Host expr round((sum(node_filesystem_size_bytes{cluster=~\"$cluster|\", job!~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster|\", job!~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) / ((sum(node_filesystem_size_bytes{cluster=~\"$cluster|\", job!~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster|\", job!~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) + sum(node_filesystem_avail_bytes{cluster=~\"$cluster|\", job!~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) * 100 > 0) message Host {{ $labels.nodename }}: High Disk Overall Utilization {{ $value }}% name HostDiskOverallHigh thresholds critical: 90 operator: '>=' warning: 75 panel Property Value dataLinks - title: System Overview url: /d/nodeexporter?var-job=$job&refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to description The percentage of the disk utilization is calculated using the fraction: <space used>/(<space used> + <space free>) The value of is reduced by 5% of the available disk capacity, because the file system marks 5% of the available disk capacity as reserved. If less than 5% is free, using the remaining reserved space requires root privileges. Any non-privileged users and processes are unable to write new data to the partition. See the list of explicitly ignored mount points and file systems [here](https://github.com/dNationCloud/kubernetes-monitoring-stack/blob/main/chart/values.yaml) expr max(round((sum(node_filesystem_size_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) / ((sum(node_filesystem_size_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) + sum(node_filesystem_avail_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) * 100 > 0)) gridPos x: 12 y: 6 thresholds critical: 90 operator: '>=' warning: 75 title Overall Utilization","title":"overallUtilizationDisk"},{"location":"docs/documentation/#overallutilizationram","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Host expr round((1 - sum by (job, nodename) (node_memory_MemAvailable_bytes{cluster=~\"$cluster|\", job!~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) / sum by (job, nodename) (node_memory_MemTotal_bytes{cluster=~\"$cluster|\", job!~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info))) * 100) message Host {{ $labels.nodename }}: High RAM Overall Utilization {{ $value }}% name HostRAMOverallHigh thresholds critical: 90 operator: '>=' warning: 75 panel Property Value dataLinks - title: System Overview url: /d/nodeexporter?var-job=$job&refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to description The percentage of the memory utilization is calculated by: 1 - (<memory available>/<memory total>) expr avg(round((1 - sum by (job, nodename) (node_memory_MemAvailable_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) / sum by (job, nodename) (node_memory_MemTotal_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info))) * 100)) gridPos x: 6 y: 6 thresholds critical: 90 operator: '>=' warning: 75 title Overall Utilization","title":"overallUtilizationRAM"},{"location":"docs/documentation/#targetdown","text":"Property Value alert alert panel None alert Property Value customLables alertgroup: Host expr 100 * (count by(job, namespace, service) (up{alertGroup=\"Host\"} == 0) / count by(job, namespace, service) (up{alertGroup=\"Host\"})) message {{ printf \"%.4g\" $value }}% of the {{ $labels.job }}/{{ $labels.service }} targets in {{ $labels.namespace }} namespace are down. name HostTargetDown thresholds critical: 90 operator: '>=' warning: 10","title":"targetDown"},{"location":"docs/documentation/#totalcores","text":"Property Value panel panel panel Property Value colorMode value expr count(node_cpu_seconds_total{cluster=~\"$cluster\", job=~\"$job\", mode=\"system\"}) graphMode none gridPos h: 2 w: 3 x: 3 y: 9 thresholds color: '#ffffff' value: title Total Cores unit none","title":"totalCores"},{"location":"docs/documentation/#totaldisk","text":"Property Value panel panel panel Property Value colorMode value expr sum(node_filesystem_size_bytes{cluster=~\"$cluster\", job=~\"$job\"}) graphMode none gridPos h: 2 w: 3 x: 15 y: 9 thresholds color: '#ffffff' value: title Total unit bytes","title":"totalDisk"},{"location":"docs/documentation/#totalram","text":"Property Value panel panel panel Property Value colorMode value expr sum(node_memory_MemTotal_bytes{cluster=~\"$cluster\", job=~\"$job\"}) graphMode none gridPos h: 2 w: 3 x: 9 y: 9 thresholds color: '#ffffff' value: title Total unit bytes","title":"totalRAM"},{"location":"docs/documentation/#usedcores","text":"Property Value panel panel panel Property Value colorMode value expr (1 - (avg(irate(node_cpu_seconds_total{cluster=~\"$cluster\", job=~\"$job\", mode=\"idle\"}[5m])))) * count(node_cpu_seconds_total{cluster=~\"$cluster\", job=~\"$job\", mode=\"system\"}) graphMode none gridPos h: 2 w: 3 x: 0 y: 9 thresholds color: '#ffffff' value: title Used Cores unit none","title":"usedCores"},{"location":"docs/documentation/#useddisk","text":"Property Value panel panel panel Property Value colorMode value expr sum(node_filesystem_size_bytes{cluster=~\"$cluster\", job=~\"$job\"}) * ((max((sum(node_filesystem_size_bytes{cluster=~\"$cluster\", job=~\"$job\"}) by (device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster\", job=~\"$job\"}) by (device)) / (sum(node_filesystem_size_bytes{cluster=~\"$cluster\", job=~\"$job\"}) by (device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster\", job=~\"$job\"}) by (device) + sum(node_filesystem_avail_bytes{cluster=~\"$cluster\", job=~\"$job\"}) by (device))))) graphMode none gridPos h: 2 w: 3 x: 12 y: 9 thresholds color: '#ffffff' value: title Used unit bytes","title":"usedDisk"},{"location":"docs/documentation/#usedram","text":"Property Value panel panel panel Property Value colorMode value expr sum(node_memory_MemTotal_bytes{cluster=~\"$cluster\", job=~\"$job\"}) * (((1 - sum(node_memory_MemAvailable_bytes{cluster=~\"$cluster\", job=~\"$job\"}) / sum(node_memory_MemTotal_bytes{cluster=~\"$cluster\", job=~\"$job\"})))) graphMode none gridPos h: 2 w: 3 x: 6 y: 9 thresholds color: '#ffffff' value: title Used unit bytes","title":"usedRAM"},{"location":"docs/documentation/#hostapps","text":"Property Value apache apache autoscaler autoscaler cAdvisor cAdvisor genericApp genericApp javaActuator javaActuator nginxIngress nginxIngress nginxNrpe nginxNrpe nginxVts nginxVts phpFpm phpFpm postfix postfix pythonFlask pythonFlask rabbitmq rabbitmq","title":"hostApps"},{"location":"docs/documentation/#apache","text":"Property Value alert {} default False panel panel panel Property Value expr (sum(up{%(job)s}) / count(up{cluster=~\"$cluster|\", %(job)s}))*100 OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 95 lowest: 0 operator: < warning: 99","title":"apache"},{"location":"docs/documentation/#autoscaler","text":"Property Value alert alert default False panel panel alert Property Value customLables alertgroup: HostApp expr (sum by (job) (autoscaler_healthy{cluster=~\"$cluster|\", job=~\".+\"}) / sum by (job) (autoscaler_instances{cluster=~\"$cluster|\", job=~\".+\"}) * 100) message HostApp {{ $labels.job }}: Autoscaler Health Low {{ $value }}% name HostAppAutoscalerHealthLow thresholds critical: 85 lowest: 0 operator: < warning: 95 panel Property Value expr (sum by (job) (autoscaler_healthy{cluster=~\"$cluster|\", %(job)s}) / sum by (job) (autoscaler_instances{cluster=~\"$cluster|\", %(job)s}) * 100) OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 85 lowest: 0 operator: < warning: 95","title":"autoscaler"},{"location":"docs/documentation/#cadvisor","text":"Property Value alert {} default False panel panel panel Property Value expr (sum(up{%(job)s}) / count(up{cluster=~\"$cluster|\", %(job)s}))*100 OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 95 lowest: 0 operator: < warning: 99","title":"cAdvisor"},{"location":"docs/documentation/#genericapp","text":"Property Value alert {} default False panel panel panel Property Value description GenericApp template. Used when application monitoring is requested but appropriate template was not found. expr (sum(up{%(job)s}) / count(up{cluster=~\"$cluster|\", %(job)s}))*100 gridPos w: 4 thresholds critical: 95 operator: < warning: 99","title":"genericApp"},{"location":"docs/documentation/#javaactuator","text":"Property Value alert alert default False panel panel alert Property Value customLables alertgroup: HostApp expr (sum by (job) (jvm_memory_used_bytes{cluster=~\"$cluster|\", job=~\".+\", area=\"heap\"})*100/sum by (job) (jvm_memory_max_bytes{cluster=~\"$cluster|\", job=~\".+\", area=\"nonheap\"}) > sum by (job) (jvm_memory_used_bytes{cluster=~\"$cluster|\", job=~\".+\", area=\"nonheap\"})*100/sum by (job) (jvm_memory_max_bytes{cluster=~\"$cluster|\", job=~\".+\", area=\"heap\"}) or (sum by (job) (jvm_memory_used_bytes{cluster=~\"$cluster|\", job=~\".+\", area=\"nonheap\"})*100)/sum by (job) (jvm_memory_max_bytes{cluster=~\"$cluster|\", job=~\".+\", area=\"heap\"})) message HostApp {{ $labels.job }}: Java Actuator Heap High {{ $value }}% name HostAppJavaActuatorHeapHigh thresholds critical: 90 lowest: 0 operator: '>=' warning: 75 panel Property Value expr (sum by (job) (jvm_memory_used_bytes{cluster=~\"$cluster|\", %(job)s, area=\"heap\"})*100/sum by (job) (jvm_memory_max_bytes{cluster=~\"$cluster|\", %(job)s, area=\"nonheap\"}) > sum by (job) (jvm_memory_used_bytes{cluster=~\"$cluster|\", %(job)s, area=\"nonheap\"})*100/sum by (job) (jvm_memory_max_bytes{cluster=~\"$cluster|\", %(job)s, area=\"heap\"}) or (sum by (job) (jvm_memory_used_bytes{cluster=~\"$cluster|\", %(job)s, area=\"nonheap\"})*100)/sum by (job) (jvm_memory_max_bytes{cluster=~\"$cluster|\", %(job)s, area=\"heap\"})) OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 90 lowest: 0 operator: '>=' warning: 75","title":"javaActuator"},{"location":"docs/documentation/#nginxingress","text":"Property Value alert alert default False panel panel alert Property Value customLables alertgroup: HostApp expr ((sum by (job) (rate(nginx_ingress_controller_requests{cluster=~\"$cluster|\", job=~\".+\", status!~\"[4-5].*\"}[5m])) / sum by (job) (rate(nginx_ingress_controller_requests{cluster=~\"$cluster|\", job=~\".+\"}[5m])) * 100) > 0 OR (sum by (job) (rate(nginx_ingress_controller_requests{cluster=~\"$cluster|\", job=~\".+\"}[5m])) + 100)) message HostApp {{ $labels.job }}: Nginx Ingress Success Rate (non-4|5xx responses) Low {{ $value }}% name HostAppNginxIngressSuccessRateLow thresholds critical: 85 lowest: 0 operator: < warning: 95 panel Property Value expr ((sum by (job) (rate(nginx_ingress_controller_requests{cluster=~\"$cluster|\", %(job)s, status!~\"[4-5].*\"}[5m])) / sum by (job) (rate(nginx_ingress_controller_requests{cluster=~\"$cluster|\", %(job)s}[5m])) * 100) > 0 OR (sum by (job) (rate(nginx_ingress_controller_requests{cluster=~\"$cluster|\", %(job)s}[5m])) + 100)) OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 85 lowest: 0 operator: < warning: 95","title":"nginxIngress"},{"location":"docs/documentation/#nginxnrpe","text":"Property Value alert {} default False panel panel panel Property Value expr (sum(up{%(job)s}) / count(up{cluster=~\"$cluster|\", %(job)s}))*100 OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 95 lowest: 0 operator: < warning: 99","title":"nginxNrpe"},{"location":"docs/documentation/#nginxvts","text":"Property Value alert alert default False panel panel alert Property Value customLables alertgroup: HostApp expr (sum by (job) (rate(nginx_server_requests{cluster=~\"$cluster|\", job=~\".+\", code!~\"[4-5].*\", code!=\"total\"}[5m])) / sum by (job) (rate(nginx_server_requests{cluster=~\"$cluster|\", job=~\".+\", code!=\"total\"}[5m])) * 100) > 0 OR (sum by (job) (rate(nginx_server_requests{cluster=~\"$cluster|\", job=~\".+\"}[5m])) + 100) message HostApp {{ $labels.job }}: Nginx VTS Success Rate (non-4|5xx responses) Low {{ $value }}% name HostAppNginxVTSSuccessRateLow thresholds critical: 85 lowest: 0 operator: < warning: 95 panel Property Value expr (sum by (job) (rate(nginx_server_requests{cluster=~\"$cluster|\", %(job)s, code!~\"[4-5].*\", code!=\"total\"}[5m])) / sum by (job) (rate(nginx_server_requests{cluster=~\"$cluster|\", %(job)s, code!=\"total\"}[5m])) * 100) > 0 OR (sum by (job) (rate(nginx_server_requests{cluster=~\"$cluster|\", %(job)s}[5m])) + 100) OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 85 lowest: 0 operator: < warning: 95","title":"nginxVts"},{"location":"docs/documentation/#phpfpm","text":"Property Value alert {} default False panel panel panel Property Value expr (sum(up{%(job)s}) / count(up{cluster=~\"$cluster|\", %(job)s}))*100 OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 95 lowest: 0 operator: < warning: 99","title":"phpFpm"},{"location":"docs/documentation/#postfix","text":"Property Value alert alert default False panel panel alert Property Value customLables alertgroup: HostApp expr (sum by (job) (postfix_size{cluster=~\"$cluster|\", job=~\".+\"})) mappings - text: '-' type: 1 value: -1 message HostApp {{ $labels.job }}: Postfix Queue Size High {{ $value }}% name HostAppPostfixQueueSizeHigh thresholds critical: 10 lowest: 0 operator: '>=' warning: 5 panel Property Value expr (sum by (job) (postfix_size{cluster=~\"$cluster|\", %(job)s})) OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 10 lowest: 0 operator: '>=' warning: 5 unit mailq","title":"postfix"},{"location":"docs/documentation/#pythonflask","text":"Property Value alert alert default False panel panel alert Property Value customLables alertgroup: HostApp expr (sum by (job) (rate(flask_http_request_duration_seconds_count{cluster=~\"$cluster|\", job=~\".+\",status!~\"[4-5].*\"}[5m])) / sum by (job) (rate(flask_http_request_duration_seconds_count{cluster=~\"$cluster|\", job=~\".+\"}[5m])) * 100) > 0 OR (sum by (job) (rate(flask_http_request_duration_seconds_count{cluster=~\"$cluster|\", job=~\".+\"}[5m])) + 100) message HostApp {{ $labels.job }}: Python Flask Success Rate (non-4|5xx responses) Low {{ $value }}% name HostAppPythonFlaskSuccessRateLow thresholds critical: 85 lowest: 0 operator: < warning: 95 panel Property Value expr (sum by (job) (rate(flask_http_request_duration_seconds_count{cluster=~\"$cluster|\", %(job)s,status!~\"[4-5].*\"}[5m])) / sum by (job) (rate(flask_http_request_duration_seconds_count{cluster=~\"$cluster|\", %(job)s}[5m])) * 100) > 0 OR (sum by (job) (rate(flask_http_request_duration_seconds_count{cluster=~\"$cluster|\", %(job)s}[5m])) + 100) OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 85 lowest: 0 operator: < warning: 95","title":"pythonFlask"},{"location":"docs/documentation/#rabbitmq","text":"Property Value alert {} default False panel panel panel Property Value expr (sum(up{%(job)s}) / count(up{cluster=~\"$cluster|\", %(job)s}))*100 OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 95 lowest: 0 operator: < warning: 99","title":"rabbitmq"},{"location":"docs/documentation/#k8s_1","text":"Property Value apiServerHealth apiServerHealth controllerManagerHealth controllerManagerHealth daemonSetsHealth daemonSetsHealth deploymentsHealth deploymentsHealth etcdHealth etcdHealth kubeletHealth kubeletHealth mostUtilizedNodeCPU mostUtilizedNodeCPU mostUtilizedNodeDisk mostUtilizedNodeDisk mostUtilizedNodeNetworkErrors mostUtilizedNodeNetworkErrors mostUtilizedNodeRAM mostUtilizedNodeRAM mostUtilizedPVC mostUtilizedPVC nodeHealth nodeHealth overallNetworkErrors overallNetworkErrors overallUtilizationCPU overallUtilizationCPU overallUtilizationDisk overallUtilizationDisk overallUtilizationRAM overallUtilizationRAM proxyHealth proxyHealth pvcBound pvcBound runningContainers runningContainers runningPods runningPods runningStatefulSets runningStatefulSets schedulerHealth schedulerHealth succeededJobs succeededJobs targetDown targetDown totalCores totalCores totalDisk totalDisk totalRAM totalRAM usedCores usedCores usedDisk usedDisk usedRAM usedRAM","title":"k8s"},{"location":"docs/documentation/#apiserverhealth","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr (sum(up{cluster=~\"$cluster|\", job=\"apiserver\"}) / count(up{cluster=~\"$cluster|\", job=\"apiserver\"})) * 100 message Cluster Api Server Health Low {{ $value }}% name ClusterApiServerHealthLow thresholds critical: 95 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/apiserver?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr (sum(up{cluster=~\"$cluster|\", job=\"apiserver\"}) / count(up{cluster=~\"$cluster|\", job=\"apiserver\"})) * 100 gridPos w: 4 x: 0 y: 12 thresholds critical: 95 operator: < warning: 99 title API Server","title":"apiServerHealth"},{"location":"docs/documentation/#controllermanagerhealth","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr (sum(up{cluster=~\"$cluster|\", job=\"kube-controller-manager\"}) / count(up{cluster=~\"$cluster|\", job=\"kube-controller-manager\"})) * 100 message Cluster Controller Manager Health Low {{ $value }}% name ClusterControllerManagerHealthLow thresholds critical: 95 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/controllermanager?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr (sum(up{cluster=~\"$cluster|\", job=\"kube-controller-manager\"}) / count(up{cluster=~\"$cluster|\", job=\"kube-controller-manager\"})) * 100 gridPos w: 4 x: 4 y: 12 thresholds critical: 95 operator: < warning: 99 title Controller Manager","title":"controllerManagerHealth"},{"location":"docs/documentation/#daemonsetshealth","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr round((sum(kube_daemonset_updated_number_scheduled{cluster=~\"$cluster|\"}) + sum(kube_daemonset_status_number_available{cluster=~\"$cluster|\"})) / (2 * sum(kube_daemonset_status_desired_number_scheduled{cluster=~\"$cluster|\"})) * 100) message DaemonSets Health Low {{ $value }}% name RunningDaemonSetsHealthLow thresholds critical: 95 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/daemonsetoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr round((sum(kube_daemonset_updated_number_scheduled{cluster=~\"$cluster|\"}) + sum(kube_daemonset_status_number_available{cluster=~\"$cluster|\"})) / (2 * sum(kube_daemonset_status_desired_number_scheduled{cluster=~\"$cluster|\"})) * 100) gridPos x: 6 y: 8 thresholds critical: 95 operator: < warning: 99 title DaemonSets Health","title":"daemonSetsHealth"},{"location":"docs/documentation/#deploymentshealth","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr round((sum(kube_deployment_status_replicas_updated{cluster=~\"$cluster|\"}) + sum(kube_deployment_status_replicas_available{cluster=~\"$cluster|\"})) / (2 * sum(kube_deployment_status_replicas{cluster=~\"$cluster|\"})) * 100) message Running Deployments Health Low {{ $value }}% name RunningDeploymentsHealthLow thresholds critical: 95 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/deploymentoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr round((sum(kube_deployment_status_replicas_updated{cluster=~\"$cluster|\"}) + sum(kube_deployment_status_replicas_available{cluster=~\"$cluster|\"})) / (2 * sum(kube_deployment_status_replicas{cluster=~\"$cluster|\"})) * 100) gridPos x: 0 y: 8 thresholds critical: 95 operator: < warning: 99 title Deployments Health","title":"deploymentsHealth"},{"location":"docs/documentation/#etcdhealth","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr (sum(up{cluster=~\"$cluster|\", job=\"kube-etcd\"}) / count(up{cluster=~\"$cluster|\", job=\"kube-etcd\"})) * 100 message Cluster Etcd Health Low {{ $value }}% name ClusterEtcdHealthLow thresholds critical: 95 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/etcd?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr (sum(up{cluster=~\"$cluster|\", job=\"kube-etcd\"}) / count(up{cluster=~\"$cluster|\", job=\"kube-etcd\"})) * 100 gridPos w: 4 x: 8 y: 12 thresholds critical: 95 operator: < warning: 99 title Etcd","title":"etcdHealth"},{"location":"docs/documentation/#kubelethealth","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr (sum(up{cluster=~\"$cluster|\", job=\"kubelet\", metrics_path=\"/metrics\"}) / count(up{cluster=~\"$cluster|\", job=\"kubelet\", metrics_path=\"/metrics\"})) * 100 message Cluster Kubelet Health Low {{ $value }}% name ClusterKubeletHealthLow thresholds critical: 95 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/kubelet?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr (sum(up{cluster=~\"$cluster|\", job=\"kubelet\", metrics_path=\"/metrics\"}) / count(up{cluster=~\"$cluster|\", job=\"kubelet\", metrics_path=\"/metrics\"})) * 100 gridPos w: 4 x: 12 y: 12 thresholds critical: 95 operator: < warning: 99 title Kubelet","title":"kubeletHealth"},{"location":"docs/documentation/#mostutilizednodecpu","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr round((1 - (avg(irate(node_cpu_seconds_total{cluster=~\"$cluster|\", job=~\"node-exporter\", mode=\"idle\"}[5m]) * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename) )) * 100) message Cluster {{ $labels.nodename }}: High CPU Utilization {{ $value }}% name ClusterNodeCPUUtilizationHigh thresholds critical: 90 operator: '>=' warning: 75 panel Property Value dataLinks - title: System Overview url: /d/cpuoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to&var-instance=All - title: K8s Overview url: /d/cpunamespaceoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr max(round((1 - (avg(irate(node_cpu_seconds_total{cluster=~\"$cluster|\", job=~\"$job\", mode=\"idle\"}[5m]) * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename) )) * 100)) gridPos w: 3 x: 3 y: 17 thresholds critical: 90 operator: '>=' warning: 75 title Most Utilized Node","title":"mostUtilizedNodeCPU"},{"location":"docs/documentation/#mostutilizednodedisk","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr round((sum(node_filesystem_size_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) / ((sum(node_filesystem_size_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) + sum(node_filesystem_avail_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) * 100) message Cluster node {{ $labels.nodename }}: High Disk Utilization {{ $value }}% name ClusterHostDiskUtilizationHigh thresholds critical: 90 operator: '>=' warning: 75 panel Property Value dataLinks - title: System Overview url: /d/diskoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to&var-instance=All description The percentage of the disk utilization is calculated using the fraction: <space used>/(<space used> + <space free>) The value of is reduced by 5% of the available disk capacity, because the file system marks 5% of the available disk capacity as reserved. If less than 5% is free, using the remaining reserved space requires root privileges. Any non-privileged users and processes are unable to write new data to the partition. See the list of explicitly ignored mount points and file systems [here](https://github.com/dNationCloud/kubernetes-monitoring-stack/blob/main/chart/values.yaml) expr max(round((sum(node_filesystem_size_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) / ((sum(node_filesystem_size_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) + sum(node_filesystem_avail_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) * 100)) gridPos w: 3 x: 15 y: 17 thresholds critical: 90 operator: '>=' warning: 75 title Most Utilized Node","title":"mostUtilizedNodeDisk"},{"location":"docs/documentation/#mostutilizednodenetworkerrors","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr sum(rate(node_network_transmit_errs_total{cluster=~\"$cluster|\", job=~\"node-exporter\", device!~\"lo|veth.+|docker.+|flannel.+|cali.+|cbr.|cni.+|br.+\"} [5m]) * on(instance) group_left(nodename) (node_uname_info) ) by (job, nodename) + sum(rate(node_network_receive_errs_total{cluster=~\"$cluster|\", job=~\"node-exporter\", device!~\"lo|veth.+|docker.+|flannel.+|cali.+|cbr.|cni.+|br.+\"}[5m]) * on(instance) group_left(nodename) (node_uname_info) ) by (job, nodename) message Cluster node {{ $labels.nodename }}: High Network Errors Count {{ $value }}% name ClusterHostNetworkErrorsHigh thresholds critical: 15 operator: '>=' warning: 10 panel Property Value dataLinks - title: System Overview url: /d/networkoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to&var-instance=All - title: K8s Overview url: /d/networknamespaceoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr max(sum(rate(node_network_transmit_errs_total{cluster=~\"$cluster|\", job=~\"$job\", device!~\"lo|veth.+|docker.+|flannel.+|cali.+|cbr.|cni.+|br.+\"} [5m]) * on(instance) group_left(nodename) (node_uname_info) ) by (job, nodename) + sum(rate(node_network_receive_errs_total{cluster=~\"$cluster|\", job=~\"$job\", device!~\"lo|veth.+|docker.+|flannel.+|cali.+|cbr.|cni.+|br.+\"}[5m]) * on(instance) group_left(nodename) (node_uname_info) ) by (job, nodename)) gridPos w: 3 x: 21 y: 17 thresholds critical: 15 operator: '>=' warning: 10 title Most Affected Node unit pps","title":"mostUtilizedNodeNetworkErrors"},{"location":"docs/documentation/#mostutilizednoderam","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr round((1 - sum by (job, nodename) (node_memory_MemAvailable_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) / sum by (job, nodename) (node_memory_MemTotal_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info))) * 100) message Cluster node {{ $labels.nodename }}: High RAM Utilization {{ $value }}% name ClusterNodesRAMUtilizationHigh thresholds critical: 90 operator: '>=' warning: 75 panel Property Value dataLinks - title: System Overview url: /d/memoryoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to&var-instance=All - title: K8s Overview url: /d/memorynamespaceoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to description The percentage of the memory utilization is calculated by: 1 - (<memory available>/<memory total>) expr max(round((1 - sum by (job, nodename) (node_memory_MemAvailable_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) / sum by (job, nodename) (node_memory_MemTotal_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info))) * 100)) gridPos w: 3 x: 9 y: 17 thresholds critical: 90 operator: '>=' warning: 75 title Most Utilized Node","title":"mostUtilizedNodeRAM"},{"location":"docs/documentation/#mostutilizedpvc","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr sum(((kubelet_volume_stats_capacity_bytes{cluster=~\"$cluster|\"} - kubelet_volume_stats_available_bytes{cluster=~\"$cluster|\"}) / kubelet_volume_stats_capacity_bytes{cluster=~\"$cluster|\"}) * 100) by (persistentvolumeclaim) message \"{{ $labels.persistentvolumeclaim }}\": High PVC Utilization {{ $value }}% name PVCUtilizationHigh thresholds critical: 97 lowest: 0 operator: '>=' warning: 85 panel Property Value dataLinks - title: K8s Overview url: /d/pvcoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr max(sum(((kubelet_volume_stats_capacity_bytes{cluster=~\"$cluster|\"} - kubelet_volume_stats_available_bytes{cluster=~\"$cluster|\"}) / kubelet_volume_stats_capacity_bytes{cluster=~\"$cluster|\"}) * 100) by (persistentvolumeclaim)) OR on() vector(-1) gridPos w: 3 x: 21 y: 8 mappings - text: '-' type: 1 value: -1 thresholds critical: 97 lowest: 0 operator: '>=' warning: 85 title Most Utilized PVC","title":"mostUtilizedPVC"},{"location":"docs/documentation/#nodehealth","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr round(sum(kube_node_info{cluster=~\"$cluster|\"}) / (sum(kube_node_info{cluster=~\"$cluster|\"}) + sum(kube_node_spec_unschedulable{cluster=~\"$cluster|\"}) + sum(kube_node_status_condition{cluster=~\"$cluster|\", condition=~\"DiskPressure|MemoryPressure|PIDPressure\", status=~\"true|unknown\"}) + sum(kube_node_status_condition{cluster=~\"$cluster|\", condition=\"Ready\", status=~\"false|unknown\"}) ) * 100) message \"{{ $labels.node }}\": Node Health Low {{ $value }}% name NodesHealthLow thresholds critical: 95 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/nodeoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr avg(round(sum(kube_node_info{cluster=~\"$cluster|\"}) / (sum(kube_node_info{cluster=~\"$cluster|\"}) + sum(kube_node_spec_unschedulable{cluster=~\"$cluster|\"}) + sum(kube_node_status_condition{cluster=~\"$cluster|\", condition=~\"DiskPressure|MemoryPressure|PIDPressure\", status=~\"true|unknown\"}) + sum(kube_node_status_condition{cluster=~\"$cluster|\", condition=\"Ready\", status=~\"false|unknown\"}) ) * 100)) gridPos x: 0 y: 5 thresholds critical: 95 operator: < warning: 99 title Nodes Health","title":"nodeHealth"},{"location":"docs/documentation/#overallnetworkerrors_1","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr sum(sum(rate(node_network_transmit_errs_total{cluster=~\"$cluster|\", job=~\"node-exporter\", device!~\"lo|veth.+|docker.+|flannel.+|cali.+|cbr.|cni.+|br.+\"} [5m]) * on(instance) group_left(nodename) (node_uname_info) ) by (job, nodename) + sum(rate(node_network_receive_errs_total{cluster=~\"$cluster|\", job=~\"node-exporter\", device!~\"lo|veth.+|docker.+|flannel.+|cali.+|cbr.|cni.+|br.+\"}[5m]) * on(instance) group_left(nodename) (node_uname_info) ) by (job, nodename)) message Cluster High Overall Network Errors Count {{ $value }}% name ClusterNetworkOverallErrorsHigh thresholds critical: 15 operator: '>=' warning: 10 panel Property Value dataLinks - title: System Overview url: /d/networkoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to&var-instance=All - title: K8s Overview url: /d/networknamespaceoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr sum(sum(rate(node_network_transmit_errs_total{cluster=~\"$cluster|\", job=~\"$job\", device!~\"lo|veth.+|docker.+|flannel.+|cali.+|cbr.|cni.+|br.+\"} [5m]) * on(instance) group_left(nodename) (node_uname_info) ) by (job, nodename) + sum(rate(node_network_receive_errs_total{cluster=~\"$cluster|\", job=~\"$job\", device!~\"lo|veth.+|docker.+|flannel.+|cali.+|cbr.|cni.+|br.+\"}[5m]) * on(instance) group_left(nodename) (node_uname_info) ) by (job, nodename)) gridPos w: 3 x: 18 y: 17 thresholds critical: 15 operator: '>=' warning: 10 title Overall Errors unit pps","title":"overallNetworkErrors"},{"location":"docs/documentation/#overallutilizationcpu_1","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr avg(round((1 - (avg(irate(node_cpu_seconds_total{cluster=~\"$cluster|\", job=~\"node-exporter\", mode=\"idle\"}[5m]) * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename) )) * 100)) message Cluster High CPU Overall Utilization {{ $value }}% name ClusterCPUOverallHigh thresholds critical: 90 operator: '>=' warning: 75 panel Property Value dataLinks - title: System Overview url: /d/cpuoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to&var-instance=All - title: K8s Overview url: /d/cpunamespaceoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr avg(round((1 - (avg(irate(node_cpu_seconds_total{cluster=~\"$cluster|\", job=~\"$job\", mode=\"idle\"}[5m]) * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename) )) * 100)) gridPos w: 3 x: 0 y: 17 thresholds critical: 90 operator: '>=' warning: 75 title Overall Utilization","title":"overallUtilizationCPU"},{"location":"docs/documentation/#overallutilizationdisk_1","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr avg(round((sum(node_filesystem_size_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) / ((sum(node_filesystem_size_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) + sum(node_filesystem_avail_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) * 100 > 0)) message Cluster High Disk Overall Utilization {{ $value }}% name ClusterDiskOverallHigh thresholds critical: 90 operator: '>=' warning: 75 panel Property Value dataLinks - title: System Overview url: /d/diskoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to&var-instance=All description The percentage of the disk utilization is calculated using the fraction: <space used>/(<space used> + <space free>) The value of is reduced by 5% of the available disk capacity, because the file system marks 5% of the available disk capacity as reserved. If less than 5% is free, using the remaining reserved space requires root privileges. Any non-privileged users and processes are unable to write new data to the partition. See the list of explicitly ignored mount points and file systems [here](https://github.com/dNationCloud/kubernetes-monitoring-stack/blob/main/chart/values.yaml) expr avg(round((sum(node_filesystem_size_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) / ((sum(node_filesystem_size_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) + sum(node_filesystem_avail_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) by (job, nodename, device)) * 100 > 0)) gridPos w: 3 x: 12 y: 17 thresholds critical: 90 operator: '>=' warning: 75 title Overall Utilization","title":"overallUtilizationDisk"},{"location":"docs/documentation/#overallutilizationram_1","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr avg(round((1 - sum by (job, nodename) (node_memory_MemAvailable_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info)) / sum by (job, nodename) (node_memory_MemTotal_bytes{cluster=~\"$cluster|\", job=~\"node-exporter\"} * on(instance) group_left(nodename) (node_uname_info))) * 100)) message Cluster High RAM Overall Utilization {{ $value }}% name ClusterRAMOverallHigh thresholds critical: 90 operator: '>=' warning: 75 panel Property Value dataLinks - title: System Overview url: /d/memoryoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to&var-instance=All - title: K8s Overview url: /d/memorynamespaceoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to description The percentage of the memory utilization is calculated by: 1 - (<memory available>/<memory total>) expr avg(round((1 - sum by (job, nodename) (node_memory_MemAvailable_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info)) / sum by (job, nodename) (node_memory_MemTotal_bytes{cluster=~\"$cluster|\", job=~\"$job\"} * on(instance) group_left(nodename) (node_uname_info))) * 100)) gridPos w: 3 x: 6 y: 17 thresholds critical: 90 operator: '>=' warning: 75 title Overall Utilization","title":"overallUtilizationRAM"},{"location":"docs/documentation/#proxyhealth","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr (sum(up{cluster=~\"$cluster|\", job=\"kube-proxy\"}) / count(up{cluster=~\"$cluster|\", job=\"kube-proxy\"})) * 100 message Cluster Proxy Health Low {{ $value }}% name ClusterProxyHealthLow thresholds critical: 95 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/proxy?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr (sum(up{cluster=~\"$cluster|\", job=\"kube-proxy\"}) / count(up{cluster=~\"$cluster|\", job=\"kube-proxy\"})) * 100 gridPos w: 4 x: 16 y: 12 thresholds critical: 95 operator: < warning: 99 title Proxy","title":"proxyHealth"},{"location":"docs/documentation/#pvcbound","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr round(sum(kube_persistentvolumeclaim_status_phase{cluster=~\"$cluster|\", phase=\"Bound\"}) / ( sum(kube_persistentvolumeclaim_status_phase{cluster=~\"$cluster|\", phase=\"Bound\"}) + sum(kube_persistentvolumeclaim_status_phase{cluster=~\"$cluster|\", phase=\"Pending\"}) + sum(kube_persistentvolumeclaim_status_phase{cluster=~\"$cluster|\", phase=\"Lost\"}) ) * 100) message PVC Bound Rate Low {{ $value }}% name PVCBoundRateLow thresholds critical: 95 lowest: 0 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/pvcoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr round(sum(kube_persistentvolumeclaim_status_phase{cluster=~\"$cluster|\", phase=\"Bound\"}) / ( sum(kube_persistentvolumeclaim_status_phase{cluster=~\"$cluster|\", phase=\"Bound\"}) + sum(kube_persistentvolumeclaim_status_phase{cluster=~\"$cluster|\", phase=\"Pending\"}) + sum(kube_persistentvolumeclaim_status_phase{cluster=~\"$cluster|\", phase=\"Lost\"}) ) * 100) OR on() vector(-1) gridPos w: 3 x: 18 y: 8 mappings - text: '-' type: 1 value: -1 thresholds critical: 95 lowest: 0 operator: < warning: 99 title PVC Bound","title":"pvcBound"},{"location":"docs/documentation/#runningcontainers","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr round(sum(kube_pod_container_status_running{cluster=~\"$cluster|\"}) / (sum(kube_pod_container_status_running{cluster=~\"$cluster|\"}) + sum(kube_pod_container_status_terminated_reason{cluster=~\"$cluster|\", reason!=\"Completed\"}) + sum(kube_pod_container_status_waiting{cluster=~\"$cluster|\"})) * 100) message Running Containers Health Low {{ $value }}% name RunningContainersHealthLow thresholds critical: 95 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/containeroverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr round(sum(kube_pod_container_status_running{cluster=~\"$cluster|\"}) / (sum(kube_pod_container_status_running{cluster=~\"$cluster|\"}) + sum(kube_pod_container_status_terminated_reason{cluster=~\"$cluster|\", reason!=\"Completed\"}) + sum(kube_pod_container_status_waiting{cluster=~\"$cluster|\"})) * 100) gridPos x: 12 y: 8 thresholds critical: 95 operator: < warning: 99 title Running Containers","title":"runningContainers"},{"location":"docs/documentation/#runningpods","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr round(sum(kube_pod_status_phase{cluster=~\"$cluster|\", phase=\"Running\"}) / (sum(kube_pod_status_phase{cluster=~\"$cluster|\", phase=\"Running\"}) + sum(kube_pod_status_phase{cluster=~\"$cluster|\", phase=\"Pending\"}) + sum(kube_pod_status_phase{cluster=~\"$cluster|\", phase=\"Failed\"}) + sum(kube_pod_status_phase{cluster=~\"$cluster|\", phase=\"Unknown\"})) * 100) message Pods Health Low {{ $value }}% name RunningPodsHealthLow thresholds critical: 95 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/podoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr round(sum(kube_pod_status_phase{cluster=~\"$cluster|\", phase=\"Running\"}) / (sum(kube_pod_status_phase{cluster=~\"$cluster|\", phase=\"Running\"}) + sum(kube_pod_status_phase{cluster=~\"$cluster|\", phase=\"Pending\"}) + sum(kube_pod_status_phase{cluster=~\"$cluster|\", phase=\"Failed\"}) + sum(kube_pod_status_phase{cluster=~\"$cluster|\", phase=\"Unknown\"})) * 100) gridPos x: 12 y: 5 thresholds critical: 95 operator: < warning: 99 title Running Pods","title":"runningPods"},{"location":"docs/documentation/#runningstatefulsets","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr round(sum(kube_statefulset_status_replicas_ready{cluster=~\"$cluster|\"}) / sum(kube_statefulset_status_replicas{cluster=~\"$cluster|\"}) * 100) message StatefulSets Health Low {{ $value }}% name RunningStatefulSetsHealthLow thresholds critical: 95 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/statefulsetoverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr round(sum(kube_statefulset_status_replicas_ready{cluster=~\"$cluster|\"}) / sum(kube_statefulset_status_replicas{cluster=~\"$cluster|\"}) * 100) gridPos x: 6 y: 5 thresholds critical: 95 operator: < warning: 99 title Running StatefulSets","title":"runningStatefulSets"},{"location":"docs/documentation/#schedulerhealth","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr (sum(up{cluster=~\"$cluster|\", job=\"kube-scheduler\"}) / count(up{cluster=~\"$cluster|\", job=\"kube-scheduler\"})) * 100 message Cluster Scheduler Health Low {{ $value }}% name ClusterSchedulerHealthLow thresholds critical: 95 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/scheduler?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr (sum(up{cluster=~\"$cluster|\", job=\"kube-scheduler\"}) / count(up{cluster=~\"$cluster|\", job=\"kube-scheduler\"})) * 100 gridPos w: 4 x: 20 y: 12 thresholds critical: 95 operator: < warning: 99 title Scheduler","title":"schedulerHealth"},{"location":"docs/documentation/#succeededjobs","text":"Property Value alert alert panel panel alert Property Value customLables alertgroup: Cluster expr round(sum(kube_job_status_succeeded{cluster=~\"$cluster|\"}) / (sum(kube_job_status_succeeded{cluster=~\"$cluster|\"}) + sum(kube_job_status_failed{cluster=~\"$cluster|\"})) * 100) message Succeeded Jobs Rate Low {{ $value }}% name SucceededJobsRateLow thresholds critical: 95 lowest: 0 operator: < warning: 99 panel Property Value dataLinks - title: K8s Overview url: /d/joboverview?refresh=10s&var-datasource=$datasource&var-cluster=$cluster|&from=$__from&to=$__to expr round(sum(kube_job_status_succeeded{cluster=~\"$cluster|\"}) / (sum(kube_job_status_succeeded{cluster=~\"$cluster|\"}) + sum(kube_job_status_failed{cluster=~\"$cluster|\"})) * 100) OR on() vector(-1) gridPos x: 18 y: 5 mappings - text: '-' type: 1 value: -1 thresholds critical: 95 lowest: 0 operator: < warning: 99 title Succeeded Jobs","title":"succeededJobs"},{"location":"docs/documentation/#targetdown_1","text":"Property Value alert alert panel None alert Property Value customLables alertgroup: Cluster expr 100 * (count by(job, namespace, service) (up{alertGroup!=\"Host\"} == 0) / count by(job, namespace, service) (up{alertGroup!=\"Host\"})) message {{ printf \"%.4g\" $value }}% of the {{ $labels.job }}/{{ $labels.service }} targets in {{ $labels.namespace }} namespace are down. name ClusterTargetDown thresholds critical: 90 operator: '>=' warning: 10","title":"targetDown"},{"location":"docs/documentation/#totalcores_1","text":"Property Value panel panel panel Property Value colorMode value expr count(node_cpu_seconds_total{cluster=~\"$cluster\", job=~\"$job\", mode=\"system\"}) graphMode none gridPos h: 2 w: 3 x: 3 y: 20 thresholds color: '#ffffff' value: title Total Cores unit none","title":"totalCores"},{"location":"docs/documentation/#totaldisk_1","text":"Property Value panel panel panel Property Value colorMode value expr sum(node_filesystem_size_bytes{cluster=~\"$cluster\", job=~\"$job\"}) graphMode none gridPos h: 2 w: 3 x: 15 y: 20 thresholds color: '#ffffff' value: title Total unit bytes","title":"totalDisk"},{"location":"docs/documentation/#totalram_1","text":"Property Value panel panel panel Property Value colorMode value expr sum(node_memory_MemTotal_bytes{cluster=~\"$cluster\", job=~\"$job\"}) graphMode none gridPos h: 2 w: 3 x: 9 y: 20 thresholds color: '#ffffff' value: title Total unit bytes","title":"totalRAM"},{"location":"docs/documentation/#usedcores_1","text":"Property Value panel panel panel Property Value colorMode value expr (1 - (avg(irate(node_cpu_seconds_total{cluster=~\"$cluster\", job=~\"$job\", mode=\"idle\"}[5m])))) * count(node_cpu_seconds_total{cluster=~\"$cluster\", job=~\"$job\", mode=\"system\"}) graphMode none gridPos h: 2 w: 3 x: 0 y: 20 thresholds color: '#ffffff' value: title Used Cores unit none","title":"usedCores"},{"location":"docs/documentation/#useddisk_1","text":"Property Value panel panel panel Property Value colorMode value expr sum(node_filesystem_size_bytes{cluster=~\"$cluster\", job=~\"$job\"}) * (( avg( (sum(node_filesystem_size_bytes{cluster=~\"$cluster\", job=~\"$job\"}) by (device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster\", job=~\"$job\"}) by (device)) / (sum(node_filesystem_size_bytes{cluster=~\"$cluster\", job=~\"$job\"}) by (device) - sum(node_filesystem_free_bytes{cluster=~\"$cluster\", job=~\"$job\"}) by (device) + sum(node_filesystem_avail_bytes{cluster=~\"$cluster\", job=~\"$job\"}) by (device)) > 0 ))) graphMode none gridPos h: 2 w: 3 x: 12 y: 20 thresholds color: '#ffffff' value: title Used unit bytes","title":"usedDisk"},{"location":"docs/documentation/#usedram_1","text":"Property Value panel panel panel Property Value colorMode value expr sum(node_memory_MemTotal_bytes{cluster=~\"$cluster\", job=~\"$job\"}) * (((1 - sum(node_memory_MemAvailable_bytes{cluster=~\"$cluster\", job=~\"$job\"}) / sum(node_memory_MemTotal_bytes{cluster=~\"$cluster\", job=~\"$job\"})))) graphMode none gridPos h: 2 w: 3 x: 6 y: 20 thresholds color: '#ffffff' value: title Used unit bytes","title":"usedRAM"},{"location":"docs/documentation/#k8sapps","text":"Property Value apache apache autoscaler autoscaler cAdvisor cAdvisor genericApp genericApp javaActuator javaActuator nginxIngress nginxIngress nginxNrpe nginxNrpe nginxVts nginxVts phpFpm phpFpm postfix postfix pythonFlask pythonFlask rabbitmq rabbitmq","title":"k8sApps"},{"location":"docs/documentation/#apache_1","text":"Property Value alert {} default False panel panel panel Property Value expr (sum(up{%(job)s}) / count(up{cluster=~\"$cluster|\", %(job)s}))*100 OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 95 lowest: 0 operator: < warning: 99","title":"apache"},{"location":"docs/documentation/#autoscaler_1","text":"Property Value alert alert default False panel panel alert Property Value customLables alertgroup: ClusterApp expr (sum by (job) (autoscaler_healthy{cluster=~\"$cluster|\", job=~\".+\"}) / sum by (job) (autoscaler_instances{cluster=~\"$cluster|\", job=~\".+\"}) * 100) message ClusterApp {{ $labels.job }}: Autoscaler Health Low {{ $value }}% name ClusterAppAutoscalerHealthLow thresholds critical: 85 lowest: 0 operator: < warning: 95 panel Property Value expr (sum by (job) (autoscaler_healthy{cluster=~\"$cluster|\", %(job)s}) / sum by (job) (autoscaler_instances{cluster=~\"$cluster|\", %(job)s}) * 100) OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 85 lowest: 0 operator: < warning: 95","title":"autoscaler"},{"location":"docs/documentation/#cadvisor_1","text":"Property Value alert {} default False panel panel panel Property Value expr (sum(up{%(job)s}) / count(up{cluster=~\"$cluster|\", %(job)s}))*100 OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 95 lowest: 0 operator: < warning: 99","title":"cAdvisor"},{"location":"docs/documentation/#genericapp_1","text":"Property Value alert {} default False panel panel panel Property Value description GenericApp template. Used when application monitoring is requested but appropriate template was not found. expr (sum(up{%(job)s}) / count(up{cluster=~\"$cluster|\", %(job)s}))*100 gridPos w: 4 thresholds critical: 95 operator: < warning: 99","title":"genericApp"},{"location":"docs/documentation/#javaactuator_1","text":"Property Value alert alert default False panel panel alert Property Value customLables alertgroup: ClusterApp expr (sum by (job) (jvm_memory_used_bytes{cluster=~\"$cluster|\", job=~\".+\", area=\"heap\"})*100/sum by (job) (jvm_memory_max_bytes{cluster=~\"$cluster|\", job=~\".+\", area=\"nonheap\"}) > sum by (job) (jvm_memory_used_bytes{cluster=~\"$cluster|\", job=~\".+\", area=\"nonheap\"})*100/sum by (job) (jvm_memory_max_bytes{cluster=~\"$cluster|\", job=~\".+\", area=\"heap\"}) or (sum by (job) (jvm_memory_used_bytes{cluster=~\"$cluster|\", job=~\".+\", area=\"nonheap\"})*100)/sum by (job) (jvm_memory_max_bytes{cluster=~\"$cluster|\", job=~\".+\", area=\"heap\"})) message ClusterApp {{ $labels.job }}: Java Actuator Heap High {{ $value }}% name ClusterAppJavaActuatorHeapHigh thresholds critical: 90 lowest: 0 operator: '>=' warning: 75 panel Property Value expr (sum by (job) (jvm_memory_used_bytes{cluster=~\"$cluster|\", %(job)s, area=\"heap\"})*100/sum by (job) (jvm_memory_max_bytes{cluster=~\"$cluster|\", %(job)s, area=\"nonheap\"}) > sum by (job) (jvm_memory_used_bytes{cluster=~\"$cluster|\", %(job)s, area=\"nonheap\"})*100/sum by (job) (jvm_memory_max_bytes{cluster=~\"$cluster|\", %(job)s, area=\"heap\"}) or (sum by (job) (jvm_memory_used_bytes{cluster=~\"$cluster|\", %(job)s, area=\"nonheap\"})*100)/sum by (job) (jvm_memory_max_bytes{cluster=~\"$cluster|\", %(job)s, area=\"heap\"})) OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 90 lowest: 0 operator: '>=' warning: 75","title":"javaActuator"},{"location":"docs/documentation/#nginxingress_1","text":"Property Value alert alert default False panel panel alert Property Value customLables alertgroup: ClusterApp expr ((sum by (job) (rate(nginx_ingress_controller_requests{cluster=~\"$cluster|\", job=~\".+\", status!~\"[4-5].*\"}[5m])) / sum by (job) (rate(nginx_ingress_controller_requests{cluster=~\"$cluster|\", job=~\".+\"}[5m])) * 100) > 0 OR (sum by (job) (rate(nginx_ingress_controller_requests{cluster=~\"$cluster|\", job=~\".+\"}[5m])) + 100)) message ClusterApp {{ $labels.job }}: Nginx Ingress Success Rate (non-4|5xx responses) Low {{ $value }}% name ClusterAppNginxIngressSuccessRateLow thresholds critical: 85 lowest: 0 operator: < warning: 95 panel Property Value expr ((sum by (job) (rate(nginx_ingress_controller_requests{cluster=~\"$cluster|\", %(job)s, status!~\"[4-5].*\"}[5m])) / sum by (job) (rate(nginx_ingress_controller_requests{cluster=~\"$cluster|\", %(job)s}[5m])) * 100) > 0 OR (sum by (job) (rate(nginx_ingress_controller_requests{cluster=~\"$cluster|\", %(job)s}[5m])) + 100)) OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 85 lowest: 0 operator: < warning: 95","title":"nginxIngress"},{"location":"docs/documentation/#nginxnrpe_1","text":"Property Value alert {} default False panel panel panel Property Value expr (sum(up{%(job)s}) / count(up{cluster=~\"$cluster|\", %(job)s}))*100 OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 95 lowest: 0 operator: < warning: 99","title":"nginxNrpe"},{"location":"docs/documentation/#nginxvts_1","text":"Property Value alert alert default False panel panel alert Property Value customLables alertgroup: ClusterApp expr (sum by (job) (rate(nginx_server_requests{cluster=~\"$cluster|\", job=~\".+\", code!~\"[4-5].*\", code!=\"total\"}[5m])) / sum by (job) (rate(nginx_server_requests{cluster=~\"$cluster|\", job=~\".+\", code!=\"total\"}[5m])) * 100) > 0 OR (sum by (job) (rate(nginx_server_requests{cluster=~\"$cluster|\", job=~\".+\"}[5m])) + 100) message ClusterApp {{ $labels.job }}: Nginx VTS Success Rate (non-4|5xx responses) Low {{ $value }}% name ClusterAppNginxVTSSuccessRateLow thresholds critical: 85 lowest: 0 operator: < warning: 95 panel Property Value expr (sum by (job) (rate(nginx_server_requests{cluster=~\"$cluster|\", %(job)s, code!~\"[4-5].*\", code!=\"total\"}[5m])) / sum by (job) (rate(nginx_server_requests{cluster=~\"$cluster|\", %(job)s, code!=\"total\"}[5m])) * 100) > 0 OR (sum by (job) (rate(nginx_server_requests{cluster=~\"$cluster|\", %(job)s}[5m])) + 100) OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 85 lowest: 0 operator: < warning: 95","title":"nginxVts"},{"location":"docs/documentation/#phpfpm_1","text":"Property Value alert {} default False panel panel panel Property Value expr (sum(up{%(job)s}) / count(up{cluster=~\"$cluster|\", %(job)s}))*100 OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 95 lowest: 0 operator: < warning: 99","title":"phpFpm"},{"location":"docs/documentation/#postfix_1","text":"Property Value alert alert default False panel panel alert Property Value customLables alertgroup: ClusterApp expr (sum by (job) (postfix_size{cluster=~\"$cluster|\", job=~\".+\"})) mappings - text: '-' type: 1 value: -1 message ClusterApp {{ $labels.job }}: Postfix Queue Size High {{ $value }}% name ClusterAppPostfixQueueSizeHigh thresholds critical: 10 lowest: 0 operator: '>=' warning: 5 panel Property Value expr (sum by (job) (postfix_size{cluster=~\"$cluster|\", %(job)s})) OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 10 lowest: 0 operator: '>=' warning: 5 unit mailq","title":"postfix"},{"location":"docs/documentation/#pythonflask_1","text":"Property Value alert alert default False panel panel alert Property Value customLables alertgroup: ClusterApp expr (sum by (job) (rate(flask_http_request_duration_seconds_count{cluster=~\"$cluster|\", job=~\".+\",status!~\"[4-5].*\"}[5m])) / sum by (job) (rate(flask_http_request_duration_seconds_count{cluster=~\"$cluster|\", job=~\".+\"}[5m])) * 100) > 0 OR (sum by (job) (rate(flask_http_request_duration_seconds_count{cluster=~\"$cluster|\", job=~\".+\"}[5m])) + 100) message ClusterApp {{ $labels.job }}: Python Flask Success Rate (non-4|5xx responses) Low {{ $value }}% name ClusterAppPythonFlaskSuccessRateLow thresholds critical: 85 lowest: 0 operator: < warning: 95 panel Property Value expr (sum by (job) (rate(flask_http_request_duration_seconds_count{cluster=~\"$cluster|\", %(job)s,status!~\"[4-5].*\"}[5m])) / sum by (job) (rate(flask_http_request_duration_seconds_count{cluster=~\"$cluster|\", %(job)s}[5m])) * 100) > 0 OR (sum by (job) (rate(flask_http_request_duration_seconds_count{cluster=~\"$cluster|\", %(job)s}[5m])) + 100) OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 85 lowest: 0 operator: < warning: 95","title":"pythonFlask"},{"location":"docs/documentation/#rabbitmq_1","text":"Property Value alert {} default False panel panel panel Property Value expr (sum(up{%(job)s}) / count(up{cluster=~\"$cluster|\", %(job)s}))*100 OR on() vector(-1) gridPos w: 4 mappings - text: '-' type: 1 value: -1 thresholds critical: 95 lowest: 0 operator: < warning: 99","title":"rabbitmq"},{"location":"helpers/","text":"Helpers A set of scripts and configuration files which helps to simplify local development. Local development using KinD (Kubernetes in Docker) Prerequisites Kind Docker Helm3 Kubectl Grafana dashboards and Prometheus alerts are stored in the jsonnet templates. Jsonnet templates are shipped in compressed form by the k8s configmap. Then the k8s configmap with compressed jsonnet is consumed by kubernetes-jsonnet-translator . kubernetes-jsonnet-translator translates jsonnet templates to the plain json and generates prometheus rule or grafana configmap k8s objects. If you want to test your local changes in local KinD k8s cluster use following steps: Create KinD cluster kind create cluster --config helpers/kind_cluster_config.yaml --image kindest/node:v1.19.1 Install K8s-m8g-stack (without dNation Kubernetes Monitoring dependency) K8s-m8g-stack is an umbrella helm chart which deploys Grafana, Loki and Prometheus Operator projects. Grafana UI is exposed on port 5000 , see http://localhost:5000 (default username: admin, default password: pass) Prometheus UI is exposed on port 5001 , see http://localhost:5001 Prometheus Alertmanager UI is exposed on port 5002 , see http://localhost:5002 # Add dNation helm repository helm repo add dnationcloud https://dnationcloud.github.io/helm-hub/ helm repo update # Install dNation Kubernetes Monitoring Stack without dNation Kubernetes Monitoring chart helm install dnation-kubernetes-monitoring-stack dnationcloud/dnation-kubernetes-monitoring-stack -f helpers/values-stack.yaml Package jsonnet templates make jsonnet-package Deploy dNation Kubernetes Monitoring with your changes # Update K8s monitoring chart dependencies helm dependency update chart # K8s monitoring only (default) helm install dnation-kubernetes-monitoring chart --set releaseOverride = dnation-kubernetes-monitoring-stack # Cluster monitoring example helm install dnation-kubernetes-monitoring chart --set releaseOverride = dnation-kubernetes-monitoring-stack -f helpers/values-cluster.yaml # Cluster monitoring example with custom dashboard templates helm install dnation-kubernetes-monitoring chart --set releaseOverride = dnation-kubernetes-monitoring-stack -f helpers/values-cluster-elk.yaml # Host monitoring example helm install dnation-kubernetes-monitoring chart --set releaseOverride = dnation-kubernetes-monitoring-stack -f helpers/values-host.yaml If you want to run jsonnet formatter or linter use following: # Format jsonnet files make jsonnet-fmt # Lint jsonnet files make jsonnet-lint If you want to generate plain json grafana dashboards or prometheus rules use following: # Build json grafana dashboards make json-dashboards # Build json prometheus rules make json-rules If you want to run helm linter use following: # Lint helm chart make helm-lint","title":"Helpers"},{"location":"helpers/#helpers","text":"A set of scripts and configuration files which helps to simplify local development.","title":"Helpers"},{"location":"helpers/#local-development-using-kind-kubernetes-in-docker","text":"Prerequisites Kind Docker Helm3 Kubectl Grafana dashboards and Prometheus alerts are stored in the jsonnet templates. Jsonnet templates are shipped in compressed form by the k8s configmap. Then the k8s configmap with compressed jsonnet is consumed by kubernetes-jsonnet-translator . kubernetes-jsonnet-translator translates jsonnet templates to the plain json and generates prometheus rule or grafana configmap k8s objects. If you want to test your local changes in local KinD k8s cluster use following steps: Create KinD cluster kind create cluster --config helpers/kind_cluster_config.yaml --image kindest/node:v1.19.1 Install K8s-m8g-stack (without dNation Kubernetes Monitoring dependency) K8s-m8g-stack is an umbrella helm chart which deploys Grafana, Loki and Prometheus Operator projects. Grafana UI is exposed on port 5000 , see http://localhost:5000 (default username: admin, default password: pass) Prometheus UI is exposed on port 5001 , see http://localhost:5001 Prometheus Alertmanager UI is exposed on port 5002 , see http://localhost:5002 # Add dNation helm repository helm repo add dnationcloud https://dnationcloud.github.io/helm-hub/ helm repo update # Install dNation Kubernetes Monitoring Stack without dNation Kubernetes Monitoring chart helm install dnation-kubernetes-monitoring-stack dnationcloud/dnation-kubernetes-monitoring-stack -f helpers/values-stack.yaml Package jsonnet templates make jsonnet-package Deploy dNation Kubernetes Monitoring with your changes # Update K8s monitoring chart dependencies helm dependency update chart # K8s monitoring only (default) helm install dnation-kubernetes-monitoring chart --set releaseOverride = dnation-kubernetes-monitoring-stack # Cluster monitoring example helm install dnation-kubernetes-monitoring chart --set releaseOverride = dnation-kubernetes-monitoring-stack -f helpers/values-cluster.yaml # Cluster monitoring example with custom dashboard templates helm install dnation-kubernetes-monitoring chart --set releaseOverride = dnation-kubernetes-monitoring-stack -f helpers/values-cluster-elk.yaml # Host monitoring example helm install dnation-kubernetes-monitoring chart --set releaseOverride = dnation-kubernetes-monitoring-stack -f helpers/values-host.yaml If you want to run jsonnet formatter or linter use following: # Format jsonnet files make jsonnet-fmt # Lint jsonnet files make jsonnet-lint If you want to generate plain json grafana dashboards or prometheus rules use following: # Build json grafana dashboards make json-dashboards # Build json prometheus rules make json-rules If you want to run helm linter use following: # Lint helm chart make helm-lint","title":"Local development using KinD (Kubernetes in Docker)"},{"location":"helpers/FAQ/","text":"Frequently Asked Questions (FAQ) Kubernetes Monitoring shows DOWN state for some control plane components. Are control plane components working correctly? You have to check address bindings of control plane components' metrics as follows: The metrics of etcd and kube-proxy control plane components are by default bound to the localhost that prometheus instances cannot access. Also make sure metrics of scheduler and controller-manager control plane components don't have the same address binding if you want to collect them. Edit and use kubeadm_init.yaml file to configure kubeadm init in case of fresh K8s deployment. kubeadm init --config = helpers/kubeadm_init.yaml Manual setup in case of already running K8s deployment. Setup etcd metrics bind address # On k8s master node cd /etc/kubernetes/manifests/ sudo vim etcd.yaml # Add listen-metrics-urls as etcd command option ... - --listen-metrics-urls = http://0.0.0.0:2381 ... Setup kube-proxy metrics bind address Edit kube-proxy daemon set kubectl edit ds kube-proxy -n kube-system ...containers: - command: - /usr/local/bin/kube-proxy - --config = /var/lib/kube-proxy/config.conf - --hostname-override = $( NODE_NAME ) - --metrics-bind-address = 0 .0.0.0 # Add metrics-bind-address line Edit kube-proxy config map kubectl -n kube-system edit cm kube-proxy ... kind: KubeProxyConfiguration metricsBindAddress: \"0.0.0.0:10249\" # Add metrics-bind-address host:port mode: \"\" Delete the kube-proxy pods and reapply the new configuration kubectl -n kube-system delete po -l k8s-app = kube-proxy Setup scheduler metrics bind address # On k8s master node cd /etc/kubernetes/manifests/ sudo vim kube-scheduler.yaml # Edit bind-address and port command options ... - --bind-address = 0 .0.0.0 - --port = 10251 ... Setup controller-manager metrics bind address # On k8s master node cd /etc/kubernetes/manifests/ sudo vim kube-controller-manager.yaml # Edit bind-address and port command options ... - --bind-address = 0 .0.0.0 - --port = 10252 ...","title":"FAQ"},{"location":"helpers/FAQ/#frequently-asked-questions-faq","text":"","title":"Frequently Asked Questions (FAQ)"},{"location":"helpers/FAQ/#kubernetes-monitoring-shows-down-state-for-some-control-plane-components-are-control-plane-components-working-correctly","text":"You have to check address bindings of control plane components' metrics as follows: The metrics of etcd and kube-proxy control plane components are by default bound to the localhost that prometheus instances cannot access. Also make sure metrics of scheduler and controller-manager control plane components don't have the same address binding if you want to collect them. Edit and use kubeadm_init.yaml file to configure kubeadm init in case of fresh K8s deployment. kubeadm init --config = helpers/kubeadm_init.yaml Manual setup in case of already running K8s deployment. Setup etcd metrics bind address # On k8s master node cd /etc/kubernetes/manifests/ sudo vim etcd.yaml # Add listen-metrics-urls as etcd command option ... - --listen-metrics-urls = http://0.0.0.0:2381 ... Setup kube-proxy metrics bind address Edit kube-proxy daemon set kubectl edit ds kube-proxy -n kube-system ...containers: - command: - /usr/local/bin/kube-proxy - --config = /var/lib/kube-proxy/config.conf - --hostname-override = $( NODE_NAME ) - --metrics-bind-address = 0 .0.0.0 # Add metrics-bind-address line Edit kube-proxy config map kubectl -n kube-system edit cm kube-proxy ... kind: KubeProxyConfiguration metricsBindAddress: \"0.0.0.0:10249\" # Add metrics-bind-address host:port mode: \"\" Delete the kube-proxy pods and reapply the new configuration kubectl -n kube-system delete po -l k8s-app = kube-proxy Setup scheduler metrics bind address # On k8s master node cd /etc/kubernetes/manifests/ sudo vim kube-scheduler.yaml # Edit bind-address and port command options ... - --bind-address = 0 .0.0.0 - --port = 10251 ... Setup controller-manager metrics bind address # On k8s master node cd /etc/kubernetes/manifests/ sudo vim kube-controller-manager.yaml # Edit bind-address and port command options ... - --bind-address = 0 .0.0.0 - --port = 10252 ...","title":"Kubernetes Monitoring shows DOWN state for some control plane components. Are control plane components working correctly?"},{"location":"helpers/ci_cd_image/","text":"Jsonnet A simple Docker image includes jsonnet, jsonnetfmt, jsonnet-lint, yq and jsonnet lib like grafonnet-lib and grafonnet-polystat-panel. Docker image was built for the CI/CD purposes or to avoid having to install jsonnet tools on your computer (keep it in docker). Usage # Jsonnet docker run --rm -it -v `pwd`:/src dnationcloud/jsonnet:<tagname> jsonnet -h # Jsonnet Formater docker run --rm -it -v `pwd`:/src dnationcloud/jsonnet:<tagname> jsonnetfmt -h # Jsonnet Linter docker run --rm -it -v `pwd`:/src dnationcloud/jsonnet:<tagname> jsonnet-lint -h # YQ docker run --rm -it -v `pwd`:/src dnationcloud/jsonnet:<tagname> yq -h Inspect versions docker inspect --format '{{ index .Config.Labels }}' dnationcloud/jsonnet:<tagname>","title":"Jsonnet"},{"location":"helpers/ci_cd_image/#jsonnet","text":"A simple Docker image includes jsonnet, jsonnetfmt, jsonnet-lint, yq and jsonnet lib like grafonnet-lib and grafonnet-polystat-panel. Docker image was built for the CI/CD purposes or to avoid having to install jsonnet tools on your computer (keep it in docker).","title":"Jsonnet"},{"location":"helpers/ci_cd_image/#usage","text":"# Jsonnet docker run --rm -it -v `pwd`:/src dnationcloud/jsonnet:<tagname> jsonnet -h # Jsonnet Formater docker run --rm -it -v `pwd`:/src dnationcloud/jsonnet:<tagname> jsonnetfmt -h # Jsonnet Linter docker run --rm -it -v `pwd`:/src dnationcloud/jsonnet:<tagname> jsonnet-lint -h # YQ docker run --rm -it -v `pwd`:/src dnationcloud/jsonnet:<tagname> yq -h Inspect versions docker inspect --format '{{ index .Config.Labels }}' dnationcloud/jsonnet:<tagname>","title":"Usage"}]}